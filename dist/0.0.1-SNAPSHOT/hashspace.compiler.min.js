require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({"5lNCN0":[function(a,b,c){(function(a){(function(){c.readFileSync=function(){return'/*\n * Partial grammar for hashspace that separates all statement or html element blocks\n * and return it as an Array\n * \n * The last part of this file corresponds to fragments of the JavaScript grammar \n * written by David Majda (minor modifications have been added to cope \n * with hashspace constraints)\n * @see https://github.com/dmajda/pegjs\n */\n\nTemplateFile\n  = blocks:(TemplateBlock / TextBlock)*  /*(RequireBlock / TemplateBlock / TextBlock)* */\n  {return blocks;}\n\nTextBlock\n  = lines:(!("#" _ "template") !("#" _ [a-zA-Z0-9]+ _ "template") !("#" _ "require") chars:[^\\n\\r]* eol:EOL {return chars.join("")+eol})+ \n  {return {type:"plaintext", value:lines.join(\'\')}}\n\nRequireBlock "require block" // TODO: finalize!\n  = _ "# " _ "require" _ (EOL / EOF) \n  {return {type:"require"}}\n\nTemplateBlock "template block"\n  = start:TemplateStart content:TemplateContent? end:TemplateEnd? \n  {\n    start.content=content;\n    if (end) {start.closed=true;start.endLine=end.line;};\n    return start;\n  }\n\nTemplateStart "template statement"\n  = _ "# " _ m:(("template") / (c:[a-zA-Z0-9]+ _ "template") {return c.join(\'\')})\n    S+ name:Identifier args:(TemplateController / ArgumentsDefinition / invarg:InvalidTplArgs)? _  EOL \n  {\n    var mod=""; // modifier (e.g. "export")\n    if (m!=="template") {\n      mod=m;\n    }\n    if (args && args.invalidTplArg) {\n      if (mod) {\n        mod+=" ";\n      }\n      return {type:"invalidtemplate", line:line, column:column, code: "# "+mod+"template "+name+" "+args.invalidTplArg}\n    } else {\n      if (args && args.ctl && args.constructor!==Array) {\n        // this template uses a controller\n        return {type:"template", name:name, mod:mod, controller:args.ctl, controllerRef: args.ctlref, line:line, column:column}\n      }\n      return {type:"template", name:name, mod:mod, args:(args===\'\')? []:args, line:line, column:column}\n    }\n  }\n\nTemplateController "controller"\n  = S+ "using" S+ ref:Identifier _ ":" _ ctl:JSObjectRef\n  {return {ctl:ctl, ctlref:ref}}\n\nArgumentsDefinition "arguments"\n  = _ "(" _ first:VarIdentifier? others:((_ "," _ arg:VarIdentifier) {return arg})* _ ")" \n  {var args = first ? [first] : []; if (others && others.length) args=args.concat(others);return args;}\n\nInvalidTplArgs\n  = _ chars:[^\\n\\r]+ &EOL\n  {return {invalidTplArg:chars.join(\'\')}}\n\nTemplateEnd "template end statement"\n  = _ "# " _ "/template" _ (EOL / EOF) \n  {return {type:"/template",line:line,column:column}} \n\nTemplateContent "template content" // TODO: CSSClassExpression\n  = _ blocks:(  TplTextBlock \n                / CommentBlock / HTMLCommentBlock\n                / IfBlock / ElseIfBlock / ElseBlock / EndIfBlock \n                / ForeachBlock / EndForeachBlock\n                / HTMLElement / EndHTMLElement\n                / HspComponent / EndHspComponent\n                / HspCptAttribute / EndHspCptAttribute\n                / LogBlock\n                / ExpressionBlock\n                / InvalidHTMLElement\n                / InvalidBlock)* \n  {return blocks}\n\nTplTextBlock "text"\n  = chars:(TplTextChar)+ \n  {return {type:"text", value:chars.join(\'\'), line:line, column:column}}\n\nTplTextChar "text character"\n  = "\\\\{" {return "\\u007B"}       // { = \\u007B\n  / "\\\\}" {return "\\u007D"}       // } = \\u007D\n  / "\\\\n" {return "\\n"}\n  / EOL &TemplateEnd {return ""}  // ignore last EOL\n  / EOL _ {return " "}\n  / "#" !(_ "\\/template") {return "#"}\n  / "\\/" !"/" {return "/"}\n  / "\\\\/" {return "/"}\n  / "\\\\//" {return "//"}\n  / "\\\\<" {return "<"}\n  / [^{#/<]\n\nInvalidBlock\n  = "{" chars:[^{}#]* "}"\n  {return {type:"invalidblock", code:chars.join(\'\'), line:line, column:column}}\n\nIfBlock "if statement"\n  = "{" _ "if " _ expr:HExpression _ "}" EOS?\n  {return {type:"if", condition:expr, line:line, column:column}}\n\nElseIfBlock "elseif statement" \n  = "{" _ "else " _ "if" _ expr:HExpression _ "}" EOS?\n  {return {type:"elseif", condition:expr, line:line, column:column}}\n\nElseBlock\n  = "{" _ "else" _ "}" EOS?\n  {return {type:"else", line:line, column:column}}\n\nEndIfBlock\n  = "{" _ "/if" _ "}" EOS?\n  {return {type:"endif", line:line, column:column}}\n\nCommentBlock\n  = _ "\\/\\/" chars:[^\\r\\n]* &EOL\n  {return {type:"comment", value:chars.join(\'\')}}\n\nHTMLCommentBlock\n  = "<!--" chars:HTMLCommentChar* "-->"\n  {return {type:"comment", value:chars.join(\'\')}}\n\nHTMLCommentChar\n  = !"-" "-" !">" {return "-"}\n    / "-" !"->" {return "-"}\n    / !"--" ">" {return ">"}\n    / [^>\\-]\n\nForeachBlock\n  = "{" _ "foreach " _ args:( ForeachArgs / ("(" _ a:ForeachArgs _ ")") {return a}) _ "}" EOS?\n  {return {type:"foreach", item:args.item, key:args.key, colref:args.colref, line:line, column:column}}\n\nForeachArgs\n  = ForeachArgs1 / ForeachArgs2\n\nForeachArgs1\n  = item:VarIdentifier " " _ "in " _ col:JSObjectRef \n  {return {item:item, key:item+"_key", colref:col}}\n\nForeachArgs2\n  = key:VarIdentifier _ "," _ item:VarIdentifier " " _ "in " _ col:JSObjectRef \n  {return {item:item, key:key, colref:col}}\n\nEndForeachBlock\n  = "{" _ "/foreach" _ "}"\n  {return {type:"endforeach", line:line, column:column}}\n\nHTMLElement\n  = "<" name:HTMLName  atts:HTMLElementAttributes? S? end:"/"? ">" EOS?\n  {return {type:"element", name:name, closed:(end!==""), attributes:atts, line:line, column:column}}\n\nHTMLElementAttributes\n  = atts:((S att:(HTMLAttribute)) {return att})*\n\nEndHTMLElement // TODO support comments inside Element\n  = "</" name:HTMLName S? ">" EOS?\n  {return {type:"endelement", name:name, line:line, column:column}}\n\nHspComponent\n  = "<#" ref:JSObjectRef  atts:HTMLElementAttributes? S? end:"/"? ">" EOS?\n  {return {type:"component", ref:ref, closed:(end!==""), attributes:atts, line:line, column:column}}\n\nEndHspComponent\n  = "</#" ref:JSObjectRef S? ">" EOS?\n  {return {type:"endcomponent", ref:ref, line:line, column:column}}\n\nHspCptAttribute\n  = "<@" ref:VarIdentifier  atts:HTMLElementAttributes? S? end:"/"? ">" EOS?\n  {return {type:"cptattribute", name:ref, closed:(end!==""), attributes:atts, line:line, column:column}}\n\nEndHspCptAttribute\n  = "</@" ref:VarIdentifier S? ">" EOS?\n  {return {type:"endcptattribute", name:ref, line:line, column:column}}\n\nInvalidHTMLElement\n  = "<" code:[^\\r\\n]* EOL\n  {return {type:"invalidelement", code:\'<\'+code.join(\'\'), line:line, column:column}}\n\nHTMLName\n  = first:[a-z] next:([a-z] / [0-9] / "-")* \n  {return first + next.join("");}\n\nHTMLAttName\n  = first:[a-zA-Z#] next:([a-zA-Z] / [0-9] / "-")* \n  // uppercase chars are considered as error in the parse post-processor\n  {return first + next.join("");}\n\nHTMLAttribute\n  = name:HTMLAttName v:(_ "=" _ "\\"" value:HTMLAttributeValue "\\"" {return value;})?\n  {\n    return {type:"attribute", name:name, value:v, line:line, column:column}\n  }\n\nHTMLAttributeValue\n  = (HTMLAttributeText / ExpressionBlock)*\n\nHTMLAttributeText\n  = chars:HTMLAttributeChar+\n  {return {type:"text", value:chars.join(\'\')}}\n\nHTMLAttributeChar // TODO look at W3C specs\n  =   "\\\\{" {return "\\u007B"}  // { = \\u007B\n    / "\\\\\\"" {return "\\""}\n    / [^{\\"\\n\\r]\n\nLogBlock\n  = "{" _ "log " _ first:HExpressionContent _ next:("," _ HExpressionContent)* _"}" EOS?\n  {\n    var exprs=[first];\n    if (next) {\n      for (var i=0, sz=next.length;sz>i;i++) {\n        exprs.push(next[i][2]);\n      }\n    }\n    return {type:"log",exprs:exprs, line:line, column:column};\n  }\n\nExpressionBlock\n  = "{" ubflag:":"? e:HExpression* "}" // keep a list of expression to match expressions starting with a valid part\n  {\n    var r={};\n    if (e.length==1) {\n      r=e[0];\n      if (r.type!=="invalidexpression") {\n        r.expType=r.type; \n        r.type="expression";\n      }\n      r.bound=(ubflag.length==0);\n      if (!r.category) {\n        r.category="jsexpression";\n      }\n    } else {\n      var code=[], itm, valid=true, t;\n      for (var i=0, sz=e.length;sz>i;i++) {\n        t=e[i].type;\n        if (t==="invalidexpression") {\n          valid=false;\n          break;\n        }\n      }\n\n      if (valid) {\n        r.type="expression";\n        r.category="jsexpression";\n        r.expType="CssClassExpression"\n        r.list=e;\n      } else {\n        // invalid expression\n        for (var i=0, sz=e.length;sz>i;i++) {\n          itm=e[i];\n          if (itm.value) {\n            code.push(itm.value);\n          } else if (itm.code) {\n            code.push(itm.code);\n          } else {\n            code.push("(...)"); // TODO\n          }\n        }\n        r.type="expression"; r.category="invalidexpression"; r.code=code.join(\'\');\n      }\n    }\n    r.line=line; \n    r.column=column;\n    return r;\n  }\n\nHExpression\n  =   HExpressionCssClassElt \n    / HExpressionContent \n    / "," __ cce:HExpressionCssClassElt {return cce}\n    / "," __ exp:HExpressionContent {return exp}\n    / InvalidExpressionValue\n\nHExpressionContent\n  =  ce:ConditionalExpressionNoIn\n  {if (!ce.category) ce.category="jsexpression"; ce.expType=ce.type;ce.line=line;ce.column=column;return ce;}\n\nHExpressionCssClassElt\n  = head:LogicalORExpression __ ":" __ tail:LogicalORExpression \n  {return {type:"CssClassElement", left:head, right:tail};}\n\nInvalidExpressionValue\n  = chars:[^}]+\n  {return {type:"invalidexpression", code:chars.join(\'\'), line:line, column:column}}\n\n// White spaces\n    // mandatory padding including line breaks\nS "white space" \n  = empty:(WhiteSpace / "\\u000D" / "\\u000A")+\n\n_   // optional padding excluding line breaks\n  = WhiteSpace*\n\nWhiteSpace "white space"\n  = [\\t\\v\\f \\u00A0\\uFEFF]\n\nEOL "end of line"\n  = "\\n"\n  / "\\r\\n"\n  / "\\r"\n  / "\\u2028" // line separator\n  / "\\u2029" // paragraph separator\n\nEOS "end of statement" //\n  = empty:(_ EOL _)\n\nEOF "end of file"\n  = !.\n\n__ // changed\n  = (WhiteSpace / EOL / Comment)*\n\nComment "comment"\n  = MultiLineComment\n  / SingleLineComment\n\nMultiLineComment\n  = "/*" (!"*/" .)* "*/"\n\nSingleLineComment\n  = "//" (!EOL .)*\n\n// ################################################################################\n\nJSObjectRef "JS object reference"\n  = start:VarIdentifier tail:(( "." pp:Identifier) {return pp}/ ( "[" idx:[0-9]+ "]") {return parseInt(idx.join(\'\'),10)})*\n  {var r=[start]; if (tail && tail.length) r=r.concat(tail);return {category:"objectref", path:r, code:r.join(\'.\')}}\n\nJSLiteral\n  = NullLiteral       { return {type:"expression", category: "null", code:"null"};}\n  / v:BooleanLiteral  { return {type:"expression", category: "boolean", value:v.value, code:""+v.value};}\n  / v:NumericLiteral  { return {type:"expression", category: "number", value: v, code:""+v};}\n  / v:StringLiteral   { return {type:"expression", category: "string",  value: v, code:""+v};}\n\n// ################################################################################\n/*!\n * The last part of this file is taken & modified from the JavaScript PEGjs grammar \n * by David Majda\n * https://github.com/dmajda/pegjs\n *\n * JavaScript parser based on the grammar described in ECMA-262, 5th ed.\n * (http://www.ecma-international.org/publications/standards/Ecma-262.htm)\n */\nSourceCharacter\n  = .\n\nIdentifier "identifier"\n  = !ReservedWord name:IdentifierName { return name; }\n\nIdentifierName "identifier"\n  = start:IdentifierStart parts:IdentifierPart* \n  {return start + parts.join("");}\n\nIdentifierStart\n  = Letter // should be UnicodeLetter to be fully ECMAScript compliant - cf. PEGS JS Grammar\n  / "$"\n  / "_"\n\nVarIdentifier "variable identifier" // same as Identifer but without underscore as first letter\n  = !ReservedWord name:VarIdentifierName { return name; }\n\nVarIdentifierName "identifier"\n  = start:VarIdentifierStart parts:IdentifierPart* \n  {return start + parts.join("");}\n\nVarIdentifierStart\n  = Letter // should be UnicodeLetter to be fully ECMAScript compliant - cf. PEGS JS Grammar\n  / "$"    // underscore is not supported as first letter\n\nIdentifierPart\n  = IdentifierStart / Digit\n\nLetter\n  = [a-zA-Z]\n\nDigit\n  = [0-9]\n\nReservedWord\n  = Keyword / FutureReservedWord / NullLiteral / BooleanLiteral\n\nKeyword\n  = (\n        "break"\n      / "case"\n      / "catch"\n      / "continue"\n      / "debugger"\n      / "default"\n      / "delete"\n      / "do"\n      / "else"\n      / "finally"\n      / "for"\n      / "function"\n      / "if"\n      / "instanceof"\n      / "in"\n      / "new"\n      / "return"\n      / "switch"\n      / "this"\n      / "throw"\n      / "try"\n      / "typeof"\n      / "var"\n      / "void"\n      / "while"\n      / "with"\n    )\n    !IdentifierPart\n\nFutureReservedWord\n  = (\n        "class"\n      / "const"\n      / "enum"\n      / "export"\n      / "extends"\n      / "import"\n      / "super"\n    )\n    !IdentifierPart\n\nNullLiteral\n  = "null" \n  {return { type: "nullliteral", value: null }; }\n\nBooleanLiteral\n  = "true"  { return { type: "booleanliteral", value: true  }; }\n  / "false" { return { type: "booleanliteral", value: false }; }\n\nNumericLiteral "number"\n  = literal:(HexIntegerLiteral / DecimalLiteral) !IdentifierStart \n  {return literal;}\n\nHexIntegerLiteral\n  = "0" [xX] digits:HexDigit+ \n  {return parseInt("0x" + digits.join(""));}\n\nHexDigit\n  = [0-9a-fA-F]\n\nDecimalLiteral\n  = before:DecimalIntegerLiteral "." after:DecimalDigits? exponent:ExponentPart? \n    {return parseFloat(before + "." + after + exponent);}\n  / "." after:DecimalDigits exponent:ExponentPart? \n    {return parseFloat("." + after + exponent);}\n  / before:DecimalIntegerLiteral exponent:ExponentPart? \n    {return parseFloat(before + exponent);}\n\nDecimalIntegerLiteral\n  = "0" / digit:NonZeroDigit digits:DecimalDigits? \n  {return digit + digits;}\n\nDecimalDigits\n  = digits:DecimalDigit+ \n  {return digits.join("");}\n\nDecimalDigit\n  = [0-9]\n\nNonZeroDigit\n  = [1-9]\n\nExponentPart\n  = indicator:ExponentIndicator integer:SignedInteger \n  {return indicator + integer;}\n\nExponentIndicator\n  = [eE]\n\nSignedInteger\n  = sign:[-+]? digits:DecimalDigits \n  {return sign + digits;}\n\nStringLiteral "string"\n  = parts:(\'"\' DoubleStringCharacters? \'"\' / "\'" SingleStringCharacters? "\'") \n  {return parts[1];}\n\nDoubleStringCharacters\n  = chars:DoubleStringCharacter+ { return chars.join(""); }\n\nSingleStringCharacters\n  = chars:SingleStringCharacter+ { return chars.join(""); }\n\nDoubleStringCharacter\n  = !(\'"\' / "\\\\" / EOL) char_:SourceCharacter { return char_;     }\n  / "\\\\" sequence:EscapeSequence              { return sequence;  }\n\nSingleStringCharacter\n  = !("\'" / "\\\\" / EOL) char_:SourceCharacter { return char_;     }\n  / "\\\\" sequence:EscapeSequence              { return sequence;  }\n\nEscapeSequence\n  = CharacterEscapeSequence\n  / "0" !DecimalDigit { return "\\0"; }\n  / HexEscapeSequence\n  / UnicodeEscapeSequence\n\nCharacterEscapeSequence\n  = SingleEscapeCharacter\n  / NonEscapeCharacter\n\nSingleEscapeCharacter\n  = char_:[\'"\\\\bfnrtv] {\n      return char_\n        .replace("b", "\\b")\n        .replace("f", "\\f")\n        .replace("n", "\\n")\n        .replace("r", "\\r")\n        .replace("t", "\\t")\n        .replace("v", "\\x0B") // IE does not recognize "\\v".\n    }\n\nNonEscapeCharacter\n  = (!EscapeCharacter / EOL) char_:SourceCharacter { return char_; }\n\nEscapeCharacter\n  = SingleEscapeCharacter\n  / DecimalDigit\n  / "x"\n  / "u"\n\nHexEscapeSequence\n  = "x" h1:HexDigit h2:HexDigit \n  {return String.fromCharCode(parseInt("0x" + h1 + h2));}\n\nUnicodeEscapeSequence\n  = "u" h1:HexDigit h2:HexDigit h3:HexDigit h4:HexDigit \n  {return String.fromCharCode(parseInt("0x" + h1 + h2 + h3 + h4));}\n\n\n/* ===== A.3 Expressions ===== */\n\nPrimaryExpression // changed \n  = name:Identifier { return { type: "Variable", name: name, code:name }; }\n  / JSLiteral\n  / ArrayLiteral\n  / ObjectLiteral\n  / "(" __ expression:Expression __ ")" { return expression; }\n\nArrayLiteral\n  = "[" __ elements:ElementList? __ (Elision __)? "]" {\n      return {\n        type:     "ArrayLiteral",\n        elements: elements !== "" ? elements : []\n      };\n    }\n\nElementList\n  = (Elision __)?\n    head:AssignmentExpression\n    tail:(__ "," __ Elision? __ AssignmentExpression)* {\n      var result = [head];\n      for (var i = 0; i < tail.length; i++) {\n        result.push(tail[i][5]);\n      }\n      return result;\n    }\n\nElision\n  = "," (__ ",")*\n\nObjectLiteral\n  = "{" __ properties:(PropertyNameAndValueList __ ("," __)?)? "}" {\n      return {\n        type:       "ObjectLiteral",\n        properties: properties !== "" ? properties[0] : []\n      };\n    }\n\nPropertyNameAndValueList\n  = head:PropertyAssignment tail:(__ "," __ PropertyAssignment)* {\n      var result = [head];\n      for (var i = 0; i < tail.length; i++) {\n        result.push(tail[i][3]);\n      }\n      return result;\n    }\n\nPropertyAssignment // changed\n  = name:PropertyName __ ":" __ value:AssignmentExpression {\n      return {\n        type:  "PropertyAssignment",\n        name:  name,\n        value: value\n      };\n    }\n\nPropertyName\n  = IdentifierName\n  / StringLiteral\n  / NumericLiteral\n\nPropertySetParameterList\n  = Identifier\n\nMemberExpression // changed\n  = base:(\n        PrimaryExpression\n    )\n    accessors:(\n        __ "[" __ name:Expression __ "]" { return name; }\n      / __ "." __ name:IdentifierName    { return name; }\n    )* {\n      var result = base;\n      for (var i = 0; i < accessors.length; i++) {\n        result = {\n          type: "PropertyAccess",\n          base: result,\n          name: accessors[i]\n        };\n      }\n      result.code=base.code\n      if (accessors.length) {\n        var acc;\n        for (var i=0, sz=accessors.length;sz>i;i++) {\n          acc=accessors[i];\n          if (acc.code) {\n            accessors[i]=acc.code;\n          }\n        }\n        result.code+="."+accessors.join(".");\n      }\n      return result;\n    }\n\nNewExpression // changed\n  = MemberExpression\n\nCallExpression\n  = base:(\n      name:MemberExpression __ arguments:Arguments {\n        return {\n          type:      "FunctionCall",\n          name:      name,\n          arguments: arguments\n        };\n      }\n    )\n    argumentsOrAccessors:(\n        __ arguments:Arguments {\n          return {\n            type:      "FunctionCallArguments",\n            arguments: arguments\n          };\n        }\n      / __ "[" __ name:Expression __ "]" {\n          return {\n            type: "PropertyAccessProperty",\n            name: name\n          };\n        }\n      / __ "." __ name:IdentifierName {\n          return {\n            type: "PropertyAccessProperty",\n            name: name\n          };\n        }\n    )* {\n      var result = base;\n      for (var i = 0; i < argumentsOrAccessors.length; i++) {\n        switch (argumentsOrAccessors[i].type) {\n          case "FunctionCallArguments":\n            result = {\n              type:      "FunctionCall",\n              name:      result,\n              arguments: argumentsOrAccessors[i].arguments\n            };\n            break;\n          case "PropertyAccessProperty":\n            result = {\n              type: "PropertyAccess",\n              base: result,\n              name: argumentsOrAccessors[i].name\n            };\n            break;\n          default:\n            throw new Error(\n              "Invalid expression type: " + argumentsOrAccessors[i].type\n            );\n        }\n      }\n      return result;\n    }\n\nArguments\n  = "(" __ arguments:ArgumentList? __ ")" {\n    return arguments !== "" ? arguments : [];\n  }\n\nArgumentList\n  = head:AssignmentExpression tail:(__ "," __ AssignmentExpression)* {\n    var result = [head];\n    for (var i = 0; i < tail.length; i++) {\n      result.push(tail[i][3]);\n    }\n    return result;\n  }\n\nLeftHandSideExpression\n  = CallExpression\n  / NewExpression\n\nPostfixExpression\n  = expression:LeftHandSideExpression _ operator:PostfixOperator {\n      return {\n        type:       "PostfixExpression",\n        operator:   operator,\n        expression: expression\n      };\n    }\n  / LeftHandSideExpression\n\nPostfixOperator\n  = "++"\n  / "--"\n\nUnaryExpression\n  = PostfixExpression\n  / operator:UnaryOperator __ expression:UnaryExpression {\n      return {\n        type:       "UnaryExpression",\n        operator:   operator,\n        expression: expression\n      };\n    }\n\nUnaryOperator // changed\n  = "void"\n  / "typeof"\n  / "++"\n  / "--"\n  / "+"\n  / "-"\n  / "~"\n  /  "!"\n\nMultiplicativeExpression\n  = head:UnaryExpression\n    tail:(__ MultiplicativeOperator __ UnaryExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nMultiplicativeOperator\n  = operator:("*" / "/" / "%") !"=" { return operator; }\n\nAdditiveExpression\n  = head:MultiplicativeExpression\n    tail:(__ AdditiveOperator __ MultiplicativeExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nAdditiveOperator\n  = "+" !("+" / "=") { return "+"; }\n  / "-" !("-" / "=") { return "-"; }\n\nShiftExpression\n  = head:AdditiveExpression\n    tail:(__ ShiftOperator __ AdditiveExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nShiftOperator\n  = "<<"\n  / ">>>"\n  / ">>"\n\nRelationalExpression\n  = head:ShiftExpression\n    tail:(__ RelationalOperator __ ShiftExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nRelationalOperator\n  = "<="\n  / ">="\n  / "<"\n  / ">"\n  / "instanceof"\n  / "in"\n\nRelationalExpressionNoIn\n  = head:ShiftExpression\n    tail:(__ RelationalOperatorNoIn __ ShiftExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nRelationalOperatorNoIn\n  = "<="\n  / ">="\n  / "<"\n  / ">"\n  / "instanceof"\n\nEqualityExpression\n  = head:RelationalExpression\n    tail:(__ EqualityOperator __ RelationalExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nEqualityExpressionNoIn\n  = head:RelationalExpressionNoIn\n    tail:(__ EqualityOperator __ RelationalExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nEqualityOperator\n  = "==="\n  / "!=="\n  / "=="\n  / "!="\n\nBitwiseANDExpression\n  = head:EqualityExpression\n    tail:(__ BitwiseANDOperator __ EqualityExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseANDExpressionNoIn\n  = head:EqualityExpressionNoIn\n    tail:(__ BitwiseANDOperator __ EqualityExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseANDOperator\n  = "&" !("&" / "=") { return "&"; }\n\nBitwiseXORExpression\n  = head:BitwiseANDExpression\n    tail:(__ BitwiseXOROperator __ BitwiseANDExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseXORExpressionNoIn\n  = head:BitwiseANDExpressionNoIn\n    tail:(__ BitwiseXOROperator __ BitwiseANDExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseXOROperator\n  = "^" !("^" / "=") { return "^"; }\n\nBitwiseORExpression\n  = head:BitwiseXORExpression\n    tail:(__ BitwiseOROperator __ BitwiseXORExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseORExpressionNoIn\n  = head:BitwiseXORExpressionNoIn\n    tail:(__ BitwiseOROperator __ BitwiseXORExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nBitwiseOROperator\n  = "|" !("|" / "=") { return "|"; }\n\nLogicalANDExpression\n  = head:BitwiseORExpression\n    tail:(__ LogicalANDOperator __ BitwiseORExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nLogicalANDExpressionNoIn\n  = head:BitwiseORExpressionNoIn\n    tail:(__ LogicalANDOperator __ BitwiseORExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nLogicalANDOperator\n  = "&&" !"=" { return "&&"; }\n\nLogicalORExpression\n  = head:LogicalANDExpression\n    tail:(__ LogicalOROperator __ LogicalANDExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nLogicalORExpressionNoIn\n  = head:LogicalANDExpressionNoIn\n    tail:(__ LogicalOROperator __ LogicalANDExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nLogicalOROperator\n  = "||" !"=" { return "||"; }\n\nConditionalExpression\n  = condition:LogicalORExpression __\n    "?" __ trueExpression:AssignmentExpression __\n    ":" __ falseExpression:AssignmentExpression {\n      return {\n        type:            "ConditionalExpression",\n        condition:       condition,\n        trueExpression:  trueExpression,\n        falseExpression: falseExpression\n      };\n    }\n  / LogicalORExpression\n\n// This is the one we use in hashspace\nConditionalExpressionNoIn\n  = condition:LogicalORExpressionNoIn __\n    "?" __ trueExpression:AssignmentExpressionNoIn __\n    ":" __ falseExpression:AssignmentExpressionNoIn {\n      return {\n        type:            "ConditionalExpression",\n        condition:       condition,\n        trueExpression:  trueExpression,\n        falseExpression: falseExpression\n      };\n    }\n  / LogicalORExpressionNoIn\n\n// Not used in hashspace\nAssignmentExpression\n  = left:LeftHandSideExpression __\n    operator:AssignmentOperator __\n    right:AssignmentExpression {\n      return {\n        type:     "AssignmentExpression",\n        operator: operator,\n        left:     left,\n        right:    right\n      };\n    }\n  / ConditionalExpression\n\nAssignmentExpressionNoIn\n  = left:LeftHandSideExpression __\n    operator:AssignmentOperator __\n    right:AssignmentExpressionNoIn {\n      return {\n        type:     "AssignmentExpression",\n        operator: operator,\n        left:     left,\n        right:    right\n      };\n    }\n  / ConditionalExpressionNoIn\n\nAssignmentOperator\n  = "=" (!"=") { return "="; }\n  / "*="\n  / "/="\n  / "%="\n  / "+="\n  / "-="\n  / "<<="\n  / ">>="\n  / ">>>="\n  / "&="\n  / "^="\n  / "|="\n\nExpression\n  = head:AssignmentExpression\n    tail:(__ "," __ AssignmentExpression)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n\nExpressionNoIn\n  = head:AssignmentExpressionNoIn\n    tail:(__ "," __ AssignmentExpressionNoIn)* {\n      var result = head;\n      for (var i = 0; i < tail.length; i++) {\n        result = {\n          type:     "BinaryExpression",\n          operator: tail[i][1],\n          left:     result,\n          right:    tail[i][3]\n        };\n      }\n      return result;\n    }\n'}}).call(a,b,void 0)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],fs:[function(a,b){b.exports=a("5lNCN0")},{}],F4GJtq:[function(a,b,c){function d(a,b){var c="";return a&&a.length&&(c=['\r\nrequire("hsp/rt").logErrors("',b,'",',JSON.stringify(a,null),");\r\n"].join("")),c}function e(a,b){if(!a.errors||!a.errors.length){for(var c=a.syntaxTree,d=[],e=0;c.length>e;e++)"template"===c[e].type&&d.push(c[e]);for(var f,g=5,h=[],i=b.split(/\n/g).length+1,j=m,k=-1,l=-1,n=-1,e=0;i>e;e++)if((0===e||e===l)&&(n=0===e?0:n+1,n<d.length?(f=d[n],k=f.startLine,l=f.endLine,k>l&&(l=k)):n=k=l=-1,0===e&&(h[0]=0),e++),e===k){for(var o=k,p=l+1;p>o;o++)h[e]=j,e++;j+=g,e-=2}else h[e]=j,j++;a.lineMap=h}}var f=a("./parser"),g=a("../klass"),h=a("./treeWalker").TreeWalker,i=a("./processors"),j=a("./jsvalidator/validator"),k=["// ################################################################ ","//  This file has been generated by the hashspace compiler          ","//  Direct MODIFICATIONS WILL BE LOST when the file is recompiled!  ","// ################################################################ ","",'var hsp=require("hsp/rt");',""],l=b.exports.HEADER=k.join("\r\n"),m=k.length;
c.compile=function(a,b,c,g){var h={},k=b.match(/[^\/]+$/),m=k?k[0]:"unknown",o="";if(m.length<b.length&&(o=b.slice(0,-m.length)),a?h=f.parse(a):h.errors=[{description:"[Hashspace compiler] template argument is undefined"}],h.code="",h.errors&&h.errors.length)h.code=l;else{var p=new n(m,o),q=p.walk(h.syntaxTree,i);c===!0&&(h.codeFragments=p.templates),h.code=l+q.join("\r\n"),h.errors=p.errors,e(h,a)}if(h.errors?h.errors.length>0&&(h.code=l):h.errors=[],0===h.errors.length&&g!==!0){var r=j.validate(h.code);if(!r.isValid){h.code=l;for(var s,t,u=h.lineMap,v=0,w=r.errors.length;w>v;v++){s=r.errors[v],t=s.line,s.line=-1;for(var x=0,y=u.length;y>x;x++)if(u[x]===t){s.line=x;break}}Array.prototype.push.apply(h.errors,r.errors)}}return h.code+=d(h.errors,m),c!==!0&&(h.syntaxTree=null),h};var n=g({$extends:h,$constructor:function(a,b){this.fileName=a,this.dirPath=b,this.templates={},this.globals={},this.errors=[],this.resetGlobalRefs(),this.resetScope()},logError:function(a,b){var c={description:a};b&&(b.line&&(c.line=b.line,c.column=b.column),b.code&&(c.code=b.code)),this.errors.push(c)},resetGlobalRefs:function(){this._globals=[],this._globalKeys={}},addGlobalRef:function(a){this._globalKeys[a]||(this._globals.push(a),this._globalKeys[a]=!0)},resetScope:function(){this._scopes=[{}],this._scope=this._scopes[0]},addScopeVariable:function(a){this._scope[a]=!0},rmScopeVariable:function(a){this._scope[a]=null},isInScope:function(a){return"scope"===a?!0:this._scope[a]?!0:!1},pushSubScope:function(a){for(var b=Object.create(this._scope),c=0,d=a.length;d>c;c++)b[a[c]]=!0;this._scopes.push(b),this._scope=this._scopes[this._scopes.length-1]},popSubScope:function(){this._scopes.pop(),this._scope=this._scopes[this._scopes.length-1]}})},{"../klass":9,"./jsvalidator/validator":5,"./parser":6,"./processors":7,"./treeWalker":8}],"hsp/compiler":[function(a,b){b.exports=a("F4GJtq")},{}],5:[function(a,b){function c(a,b){for(var c=a.toString().replace(/\s*\(\d*\:\d*\)\s*$/i,""),d=(""+b.slice(0,a.pos)).match(/.*$/i),e=(""+b.slice(a.pos)).match(/.*/i),f=d?d[0]:"",g=e?e[0]:"",h=f.length,i=g.length?g.slice(0,1):"X",j=f+g,k=[],l=0,m=j.length;m>l;l++)k[l]=l===h?"^":"-";var n=j+"\r\n"+k.join(""),o=['<span class="code">',f,'<span class="error" title="',c,'">',i,"</span>",g.slice(1),"</span>"].join("");return{description:c,lineInfoTxt:n,lineInfoHTML:o,code:j,line:a.loc?a.loc.line:-1,column:a.loc?a.loc.column:-1}}var d=a("acorn/acorn");b.exports.validate=function(a){var b={isValid:!0};try{d.parse(a,{ecmaVersion:3,strictSemicolons:!1,allowTrailingCommas:!1,forbidReserved:!0})}catch(e){b.isValid=!1,b.errors=[c(e,a)]}return b}},{"acorn/acorn":10}],6:[function(a,b,c){(function(b){function d(a){return i.parse(a+"\r\n")}var e=a("pegjs"),f=a("fs"),g=f.readFileSync(b+"/hspblocks.pegjs","utf-8"),h=a("../klass"),i=e.buildParser(g,{trackLineAndColumn:!0});c.getBlockList=d,c.parse=function(a){var b={};try{var c=d(a),e=new l;e.generateTree(c),b={syntaxTree:e.tree.content,errors:e.errors}}catch(f){b={syntaxTree:null,errors:[{description:f.toString(),line:f.line,column:f.column}]}}return b};var j=h({$constructor:function(a,b){this.type=a,this.parent=b}}),k={event:!0,scope:!0},l=h({generateTree:function(a){this.errors=[],this.tree=new j("file",null),this.tree.content=[],this._advance(0,a,this.tree.content)},_logError:function(a,b){var c={description:a};b&&(b.line&&(c.line=b.line,c.column=b.column),b.code&&(c.code=b.code)),this.errors.push(c)},displayErrors:function(){if(this.errors.length)for(var a=0,b=this.errors.length;b>a;a++)console.log("Error "+(a+1)+"/"+b+": "+this.errors[a].description)},_advance:function(a,b,c,d){var e,f;if(b){for(var g=a,h=b.length;h>g;g++){if(e=b[g],f=e.type,d&&d(f,e.name))return g;this["_"+f]?g=this["_"+f](g,b,c):this._logError("Invalid statement: "+f,e)}return b.length}},_template:function(a,b,c){var d=new j("template"),e=b[a];if(d.name=e.name,e.controller)d.controller=e.controller,d.controller.ref=e.controllerRef;else{d.args=e.args;for(var f=0,g=d.args.length;g>f;f++)k[d.args[f]]&&this._logError("Reserved keywords cannot be used as template argument: "+d.args[f],e)}return d.export="export"===e.mod,d.startLine=e.line,d.endLine=e.endLine,d.content=[],c.push(d),""!==e.mod&&"export"!==e.mod&&this._logError("Invalid template template modifier: "+e.mod,b[a]),e.closed||this._logError("Missing end template statement",e),this._advance(0,e.content,d.content),a},_invalidtemplate:function(a,b){return this._logError("Invalid template declaration",b[a]),a},_plaintext:function(a,b,c){var d=new j("plaintext"),e=b[a];return d.value=e.value,c.push(d),a},_log:function(a,b,c){var d,e=new j("log"),f=b[a],g=[];e.line=f.line,e.column=f.column;for(var h=0,i=f.exprs.length;i>h;h++)d=new m(f.exprs[h],this),g[h]=d.getSyntaxTree();return e.exprs=g,c.push(e),a},_text:function(a,b,c){for(var d,e=b.length,f=a,g=e>f,h=[],i=null,k=-1;g;){if(d=b[f],"text"===d.type)""!==d.value&&h.push(d);else if("expression"===d.type){if("jsexpression"===d.category){var l=new m(d,this);d=b[f]=l.getSyntaxTree()}"invalidexpression"===d.category?this._logError("Invalid expression",d):"functionref"!==d.category?h.push(d):(k=f,f++,g=!1)}else"comment"===d.type||(g=!1);g&&(f++,g=e>f)}return 1===h.length&&"text"===h[0].type?(i=new j("text"),i.value=h[0].value):h.length>0&&(i=new j("textblock"),i.content=h),i&&c.push(i),k>-1&&this._insert(k,b,c),f>a?f-1:a},_expression:function(a,b,c){var d=b[a],e=d.category;return"invalidexpression"===e?(this._logError("Invalid expression",d),a):this._text(a,b,c)},_invalidexpression:function(a,b){return this._logError("Invalid expression",b[a]),a},_insert:function(a,b,c){var d=new j("insert"),e=b[a];return d.path=e.path,d.args=e.args,d.path.length>1?this._logError("Long paths for insert statements are not supported yet: "+d.path.join("."),e):c.push(d),a},_if:function(a,b,c){var d=new j("if"),e=b[a],f=a,g=new m(e.condition,this);d.condition=g.getSyntaxTree(),d.condition.bound=!0,d.content1=[],c.push(d);var h=!1,i=d.content1,k=a;for("invalidexpression"===d.condition.type&&this._logError("Invalid if condition",d.condition);!h;)if(k=this._advance(k+1,b,i,this._ifEndTypes),0>k||!b[k])this._logError("Missing end if statement",b[f]),h=!0;else{var l=b[k].type;"endif"===l?h=!0:"else"===l?(d.content2=[],i=d.content2,f=k):"elseif"===l&&(d.content2=[],i=d.content2,f=k,h=!0,k=this._if(k,b,i))}return k},_ifEndTypes:function(a){return"endif"===a||"else"===a||"elseif"===a},_endif:function(a,b){var c=b[a];return this._logError("{/if} statement does not match any {if} block",c),a},_else:function(a,b){var c=b[a];return this._logError("{else} statement found outside any {if} block",c),a},_elseif:function(a,b){var c=b[a];return this._logError("{else if} statement found outside any {if} block",c),a},_foreach:function(a,b,c){var d=new j("foreach"),e=b[a];d.item=e.item,d.key=e.key,d.collection=e.colref,d.collection.bound=!0,d.content=[],c.push(d);var f=this._advance(a+1,b,d.content,this._foreachEndTypes);return(0>f||!b[f])&&this._logError("Missing end foreach statement",b[a]),f},_foreachEndTypes:function(a){return"endforeach"===a},_endforeach:function(a,b){var c=b[a];return this._logError("{/foreach} statement does not match any {foreach} block",c),a},_element:function(a,b,c){return this._elementOrComponent("element",a,b,c)},_component:function(a,b,c){return this._elementOrComponent("component",a,b,c)},_cptattribute:function(a,b,c){return this._elementOrComponent("cptattribute",a,b,c)},_elementOrComponent:function(a,b,c,d){var e=new j(a),f=c[b];e.name=f.name,e.closed=f.closed,f.ref&&(e.ref=f.ref);var g,h,i,k,l=f.attributes;e.attributes=[];for(var n=0,o=l.length;o>n;n++){g=l[n];var p=g.value.length;if(k=g.name.toLowerCase(),k!==g.name,0===p){if(""===g.value){h={name:g.name,type:"name",line:g.line,column:g.column},e.attributes.push(h);continue}g.value.push({type:"text",value:""}),p=1}if(1===p){if(i=g.value[0].type,"text"!==i&&"expression"!==i){this._logError("Invalid attribute type: "+i,g);continue}if("expression"===i){var q=g.value[0],r=q.category;if("jsexpression"===r){var s=new m(q,this);g.value[0]=s.getSyntaxTree()}else"invalidexpression"===r?this._logError("Invalid expression",q):g.name.match(/^on/i)&&"functionref"!==r&&this._logError("Event handler attribute only support function expressions",q)}h=g.value[0],h.name=g.name}else{g.name.match(/^on/i)&&this._logError("Event handler attributes don't support text and expression mix",g);for(var t=0;p>t;t++){var q=g.value[t];if("expression"===q.type)if("jsexpression"===q.category){var s=new m(q,this);g.value[t]=s.getSyntaxTree()}else"invalidexpression"===q.category&&this._logError("Invalid expression",q)}h={name:g.name,type:"textblock",content:g.value}}e.attributes.push(h)}e.content=[],d.push(e);var u=b;if(!f.closed)for(var v=!1,w=e.content,x=f.name;!v;)if(u=this._advance(u+1,c,w,function(b){return b==="end"+a}),0>u||!c[u])this._logError("Missing end "+a+" </"+x+">",f),v=!0;else{var y=c[u];if("endelement"===y.type||"endcptattribute"===y.type)c[u].name!==x&&(this._logError("Missing end "+a+" </"+x+">",f),u-=1);else{var z=this._getComponentPathAsString(f.ref),A=this._getComponentPathAsString(y.ref);z!==A&&(this._logError("Missing end component </#"+z+">",f),u-=1)}v=!0}return u},_getComponentPathAsString:function(a){return"objectref"===a.category&&a.path&&a.path.length&&a.path.join?a.path.join("."):null},_invalidelement:function(a,b){var c=b[a],d="Invalid HTML element syntax";return c.code&&c.code.match(/^<\/?\@/gi)&&(d="Invalid component attribute syntax"),this._logError(d,c),a},_comment:function(a){return a},_endelement:function(a,b){var c=b[a],d=c.name;return this._logError("End element </"+d+"> does not match any <"+d+"> element",c),a},_endcomponent:function(a,b){var c=b[a],d=this._getComponentPathAsString(c.ref);return this._logError("End component </#"+d+"> does not match any <#"+d+"> component",c),a},_endcptattribute:function(a,b){var c=b[a],d=c.name;return this._logError("End component attribute </@"+d+"> does not match any <@"+d+"> component attribute",c),a}}),m=h({$constructor:function(a,b){if(this.rootExpression=a,this.errors=null,this.globalSyntaxTree=b,a.expType&&(a.type=a.expType),"jsexpression"!==a.category)this._st=a;else{this._objectRefs=[];var c=this._process(a);if(this.rootExpression.code=c,this._st={type:"expression",category:"jsexpression",objectrefs:this._objectRefs,code:c},"a0"===c?this._st=this._objectRefs[0]:c.match(/^ *$/)&&(this._st={type:"text",value:c}),a.line&&(this._st.line=a.line,this._st.column=a.column),this.errors)for(var d=0,e=this.errors.length;e>d;d++)b._logError(this.errors[d],this.rootExpression)}},getSyntaxTree:function(){return this._st},_logError:function(a){this.errors||(this.errors=[]),this.errors.push(a)},_process:function(a){var b="";switch(a.type){case"expression":b=this._getValue(a);break;case"BinaryExpression":b="("+this._process(a.left)+" "+a.operator+" "+this._process(a.right)+")";break;case"UnaryExpression":b=""+a.operator+"("+this._process(a.expression)+")",("++"===a.operator||"--"===a.operator)&&this._logError("Unary operator "+a.operator+" is not allowed");break;case"PostfixExpression":b="("+this._process(a.expression)+")"+a.operator,this._logError("Postfix operator "+a.operator+" is not allowed");break;case"Variable":b=this._getValue({type:"expression",category:"objectref",bound:a.bound,path:[a.name]});break;case"PropertyAccess":for(var c,d=a,e=[];d;)c=d.name,e.push(c.type&&"expression"===c.type?c.value:c),d=d.base;e.reverse(),b=this._getValue({type:"expression",category:"objectref",bound:a.bound,path:e});break;case"ConditionalExpression":b="("+this._process(a.condition)+"? "+this._process(a.trueExpression)+" : "+this._process(a.falseExpression)+")";break;case"FunctionCall":for(var d=a.name,e=[];d;)e.push(d.name),d=d.base;e.reverse();var d={type:"expression",category:"functionref",bound:a.bound,path:e};b=this._getValue(d);for(var f,g=[],h=a.arguments,i=h?h.length:0,j=0;i>j;j++)h[j].category||(h[j].category="jsexpression"),f=new m(h[j],this.globalSyntaxTree),g[j]=f.getSyntaxTree();d.args=g;break;case"CssClassElement":b="(("+this._process(a.right)+")? ''+"+this._process(a.left)+":'')";break;case"CssClassExpression":for(var k=a.list,i=k.length,l=[],j=0;i>j;j++)l[j]=this._process(k[j]);b=1>i?"":"["+l.join(",")+"].join(' ')";break;case"ObjectLiteral":for(var n=a.properties,o=n.length,l=[],j=0;o>j;j++)l[j]=this._process(n[j]);b=1>o?"":"{"+l.join(",")+"}";break;case"PropertyAssignment":var p=a.name,q=a.value,l=this._process(q);b=p+":"+l;break;default:this._logError(a.type+"(s) are not supported yet"),console.warn("[HExpression] "+a.type+"(s) are not supported yet:"),console.dir(a)}return b},_getValue:function(a){var b="";switch(a.category){case"objectref":for(var c,d,e,f=this._objectRefs.length,g=0;f>g;g++)if(c=this._objectRefs[g],d=c.path.length,e=!0,"objectref"===c.category&&d===a.path.length){for(var h=0;d>h;h++)if(c.path[h]!==a.path[h]){e=!1;break}if(e){b="a"+g;break}}b||(b="a"+f,this._objectRefs[f]=a);break;case"functionref":var f=this._objectRefs.length;b="a"+f,this._objectRefs[f]=a;break;case"string":b='"'+a.value.replace(/\"/g,'\\"')+'"';break;case"boolean":case"number":b=a.value;break;case"null":b="null"}return b}})}).call(this,"/hsp/compiler")},{"../klass":9,fs:"5lNCN0",pegjs:11}],7:[function(a,b,c){function d(a){return a.replace(/\r\n?|[\n\u2028\u2029]/g,"\n").replace(/\n/g,"\\n")}function e(a){return'"'+a+'"'}function f(a,c){var d="0",e="0",f="0",i=a.attributes,j=i.length;if(j>0){for(var k,l,m,n,o=[],p=[],q=[],r=1,s=0;j>s;s++)if(m=i[s],k=o,l=m.name,m.name.match(/^on/i)&&(k=p,l=m.name.slice(2)),n=m.type,"text"===n)k.push('"'+l+'":"'+m.value+'"');else if("expression"===n){var t=g(m,r,c);r=t.nextIndex,q.push(t.code),k.push(k===p?'"'+l+'":'+t.exprIdx:'"'+l+'":["",'+t.exprIdx+"]")}else if("textblock"===n){var u=h(m,r,c);r=u.nextIndex,"0"!==u.expArg&&q.push(u.expArg.slice(1,-1)),k.push('"'+l+'":'+u.blockArgs)}else"name"===n?k.push('"'+l+'":null'):c.logError("Invalid attribute type: "+n);o.length&&(d="{"+o.join(",")+"}"),p.length&&(e="{"+p.join(",")+"}"),f=0===q.length?"0":"{"+q.join(",")+"}"}var v="";return a.content&&a.content.length&&(v=",["+c.walk(a.content,b.exports).join(",")+"]"),[f,",",d,",",e,v].join("")}function g(a,b,c){var e=a.category,f="",h=b,i=a.bound===!1?0:1,j=b;if("objectref"===e||"functionref"===e){var k=a.path,l=null,m=null,n=a.args;if(0===k.length)c.logError("Expression path cannot be empty");else{var o=k[0],p=c.isInScope(o),q=p?i:2;if("event"===o&&(q=0),2===q&&(c.addGlobalRef(o),o="_"+o,k[0]="_"+k[0]),"functionref"===e){q=p?3:4,l=[],m=[];for(var r,s,t,u=j+1,v=0,w=n.length;w>v;v++)r=n[v],s=r.category,"string"!==s&&"boolean"!==s&&"number"!==s&&(t=g(r,u,c),l.push(t.code),m[v]=t.exprIdx,u=t.nextIndex);h=u}else h++;var x,y=k[0];(p||"event"===o)&&(y='"'+y+'"');var z=k.length;if(1===z)x=["e",j,":[",q,",1,",y];else{var A,B=[];B.push(y);for(var v=1;z>v;v++)A=k[v],B.push("string"==typeof A?'"'+A+'"':A);x=["e",j,":[",q,",",z,",",B.join(",")]}if(n&&n.length>0){for(var s,r,v=0,w=n.length;w>v;v++)r=n[v],s=r.category,x.push("string"===s?',0,"'+d(r.value.replace(/"/g,'\\"'))+'"':"boolean"===s||"number"===s?",0,"+r.value:",1,"+m[v]);l&&l.length>0?(x.push("],"),x.push(l.join(","))):x.push("]")}else x.push("]");f=x.join("")}}else if("boolean"===e||"number"===e)f=["e",j,":[5,",a.value,"]"].join(""),h++;else if("string"===e)f=["e",j,':[5,"',(""+a.value).replace(/"/g,'\\"'),'"]'].join(""),h++;else if("jsexpression"===e){var C,t,D=a.objectrefs,u=j+1,E=[],F=[];void 0===D&&(console.warn("[formatExpression] The following expression has not been pre-processed - parser should be updated: "),console.dir(a));for(var n=[],w=D.length,G=w>0?",":"",v=0;w>v;v++)C=D[v],n[v]="a"+v,t=g(C,u,c),E.push(t.code),F[v]=t.exprIdx,u=t.nextIndex;var H=["function(",n.join(","),") {return ",a.code,";}"].join(""),I=["e",j,":[6,",H,G,F.join(","),"]"].join("");E.splice(0,0,I),f=E.join(","),h=F[F.length-1]+1}else c.logError("Unsupported expression: "+e,a);return{code:f,exprIdx:j,nextIndex:h}}function h(a,b,c){for(var e,f=a.content,h=f.length,i=[],j=[],k=0,l=0;h>l;l++)if(e=f[l],"text"===e.type)k%2===0?(j[k]='"'+d(e.value.replace(/"/g,'\\"'))+'"',k++):k>0?j[k-1]=j[k-1].slice(0,-1)+d(e.value.replace(/"/g,'\\"'))+'"':c.logError("Invalid textblock structure",a);else if("expression"===e.type){k%2===0&&(j[k]='""',k++);var m=g(e,b,c);b=m.nextIndex,m.code?(i.push(m.code),j[k]=m.exprIdx):j[k]=0,k++}var n="0";i.length&&(n="{"+i.join(",")+"}");var o="[]";return j.length&&(o="["+j.join(",")+"]"),{expArg:n,nextIndex:b,blockArgs:o}}c.plaintext=function(a){return a.value},c.template=function(a,c){var d=a.name,f="\r\n";if(a.args)for(var g=0,h=a.args.length;h>g;g++)c.addScopeVariable(a.args[g]);else a.controller&&c.addScopeVariable(a.controller.ref);var i=["[",c.walk(a.content,b.exports).join(","),"]"].join(""),j=c._globals,k=[],l=j.length;if(l){k=["  var _"+j.join(",_")+";"];for(var g=0;l>g;g++)k.push("try {_"+j[g]+"="+j[g]+"} catch(e) {};");k.push(f)}var m=k.join("");c.resetScope(),c.resetGlobalRefs(),c.templates[d]=i;var n="";if(a.export===!0&&(n=" =exports."+d),a.controller){var o=a.controller.path;return["var ",d,n,' = require("hsp/rt").template({ctl:[',o[0],",",c.each(o,e),'],ref:"',a.controller.ref,'"}, function(n){',f,m,"  return ",i,";",f,"});",f].join("")}return["var ",d,n,' = require("hsp/rt").template([',c.each(a.args,e),"], function(n){",f,m,"  return ",i,";",f,"});",f].join("")},c.text=function(a){return void 0===a.value?(console.dir(a),'n.$text(0,[""])'):['n.$text(0,["',d(a.value.replace(/"/g,'\\"')),'"])'].join("")},c.textblock=function(a,b){var c=h(a,1,b);return["n.$text(",c.expArg,",",c.blockArgs,")"].join("")},c.log=function(a,b){for(var c,d=1,e=[],f=[],h=0,i=a.exprs.length;i>h;h++)c=g(a.exprs[h],d,b),d=c.nextIndex,f.push(c.exprIdx),e.push(c.code);return["n.log({",e.join(","),"},[",f.join(","),"],'",b.fileName,"','",b.dirPath,"',",a.line,",",a.column,")"].join("")},c["if"]=function(a,c){var d=g(a.condition,1,c),e=",[]",f="";return a.content1&&(e=",["+c.walk(a.content1,b.exports).join(",")+"]"),a.content2&&(f=",["+c.walk(a.content2,b.exports).join(",")+"]"),""!==d.code&&(d.code="{"+d.code+"}"),["n.$if(",d.code,",",d.exprIdx,e,f,")"].join("")},c.foreach=function(a,c){var d=g(a.collection,1,c),e="[]";a.content&&(c.pushSubScope([a.item,a.key,a.item+"_isfirst",a.item+"_islast"]),e="["+c.walk(a.content,b.exports).join(",")+"]",c.popSubScope()),""!==d.code&&(d.code="{"+d.code+"}");var f=0;return["n.$foreach(",d.code,',"',a.key,'","',a.item,'",',f,",",d.exprIdx,",",e,")"].join("")},c.insert=function(a,b){a.category="functionref";var c=g(a,1,b),d=0===c.code.length?"0":"{"+c.code+"}";return["n.$insert(",d,",",c.exprIdx,")"].join("")},c.element=function(a,b){var c=f(a,b);return['n.elt("',a.name,'",',c,")"].join("")},c.component=function(a,b){var c=f(a,b),d=a.ref.path;return b.addGlobalRef(d[0]),["n.cpt([_",d[0],',"',d.join('","'),'"],',c,")"].join("")},c.cptattribute=function(a,b){var c=f(a,b);return['n.catt("',a.name,'",',c,")"].join("")}},{}],8:[function(a,b,c){var d=a("../klass"),e=d({walk:function(a,b){var c=[];if(a)for(var d=0;d<a.length;d+=1){var e=a[d].type;b[e]&&c.push(b[e](a[d],this))}return c},each:function(a,b){for(var c=[],d=0;d<a.length;d+=1){var e=b(a[d]);null!==e&&c.push(e)}return c}});c.TreeWalker=e},{"../klass":9}],9:[function(a,b){function c(){}function d(a){return Object.create?Object.create(a):(c.prototype=a,new c)}function e(){return g++,"+"+g+":"}var f=function(a){var b=a.$constructor;if(!b){var c=a.$extends;b=c?function(){c.apply(this,arguments)}:new Function,a.$constructor=b}if(a.$extends){if(!a.$extends.prototype)throw new Error("[klass] $extends attribute must be a function");var e=d(a.$extends.prototype);for(var f in a)a.hasOwnProperty(f)&&(e[f]=b[f]=a[f]);b.prototype=e}else{b.prototype=a;for(var f in a)a.hasOwnProperty(f)&&(b[f]=a[f])}return b};f.createObject=d;var g=0;f.createMetaDataPrefix=e,b.exports=f},{}],10:[function(a,b,c){!function(a){"use strict";function b(a){nb=a||{};for(var b in rb)nb.hasOwnProperty(b)||(nb[b]=rb[b]);qb=nb.sourceFile||null}function c(a,b){var c=sb(ob,a);b+=" ("+c.line+":"+c.column+")";var d=new SyntaxError(b);throw d.pos=a,d.loc=c,d.raisedAt=tb,d}function d(a){function b(a){if(1==a.length)return c+="return str === "+JSON.stringify(a[0])+";";c+="switch(str){";for(var b=0;b<a.length;++b)c+="case "+JSON.stringify(a[b])+":";c+="return true}return false;"}a=a.split(" ");var c="",d=[];a:for(var e=0;e<a.length;++e){for(var f=0;f<d.length;++f)if(d[f][0].length==a[e].length){d[f].push(a[e]);continue a}d.push([a[e]])}if(d.length>3){d.sort(function(a,b){return b.length-a.length}),c+="switch(str.length){";for(var e=0;e<d.length;++e){var g=d[e];c+="case "+g[0].length+":",b(g)}c+="}"}else b(a);return new Function("str",c)}function e(a){return 65>a?36===a:91>a?!0:97>a?95===a:123>a?!0:a>=170&&Wc.test(String.fromCharCode(a))}function f(a){return 48>a?36===a:58>a?!0:65>a?!1:91>a?!0:97>a?95===a:123>a?!0:a>=170&&Xc.test(String.fromCharCode(a))}function g(){this.line=Bb,this.column=tb-Cb}function h(){Bb=1,tb=Cb=0,Ab=!0,l()}function i(a,b){vb=tb,nb.locations&&(xb=new g),yb=a,l(),zb=b,Ab=a.beforeExpr}function j(){var a=nb.onComment&&nb.locations&&new g,b=tb,d=ob.indexOf("*/",tb+=2);if(-1===d&&c(tb-2,"Unterminated comment"),tb=d+2,nb.locations){Zc.lastIndex=b;for(var e;(e=Zc.exec(ob))&&e.index<tb;)++Bb,Cb=e.index+e[0].length}nb.onComment&&nb.onComment(!0,ob.slice(b+2,d),b,tb,a,nb.locations&&new g)}function k(){for(var a=tb,b=nb.onComment&&nb.locations&&new g,c=ob.charCodeAt(tb+=2);pb>tb&&10!==c&&13!==c&&8232!==c&&8329!==c;)++tb,c=ob.charCodeAt(tb);nb.onComment&&nb.onComment(!1,ob.slice(a+2,tb),a,tb,b,nb.locations&&new g)}function l(){for(;pb>tb;){var a=ob.charCodeAt(tb);if(32===a)++tb;else if(13===a){++tb;var b=ob.charCodeAt(tb);10===b&&++tb,nb.locations&&(++Bb,Cb=tb)}else if(10===a)++tb,++Bb,Cb=tb;else if(14>a&&a>8)++tb;else if(47===a){var b=ob.charCodeAt(tb+1);if(42===b)j();else{if(47!==b)break;k()}}else if(14>a&&a>8||32===a||160===a)++tb;else{if(!(a>=5760&&Tc.test(String.fromCharCode(a))))break;++tb}}}function m(){var a=ob.charCodeAt(tb+1);return a>=48&&57>=a?A(!0):(++tb,i(vc))}function n(){var a=ob.charCodeAt(tb+1);return Ab?(++tb,x()):61===a?w(zc,2):w(xc,1)}function o(){var a=ob.charCodeAt(tb+1);return 61===a?w(zc,2):w(Lc,1)}function p(a){var b=ob.charCodeAt(tb+1);return b===a?w(124===a?Dc:Ec,2):61===b?w(zc,2):w(124===a?Fc:Hc,1)}function q(){var a=ob.charCodeAt(tb+1);return 61===a?w(zc,2):w(Gc,1)}function r(a){var b=ob.charCodeAt(tb+1);return b===a?w(Bc,2):61===b?w(zc,2):w(Ac,1)}function s(a){var b=ob.charCodeAt(tb+1),c=1;return b===a?(c=62===a&&62===ob.charCodeAt(tb+2)?3:2,61===ob.charCodeAt(tb+c)?w(zc,c+1):w(Kc,c)):(61===b&&(c=61===ob.charCodeAt(tb+2)?3:2),w(Jc,c))}function t(a){var b=ob.charCodeAt(tb+1);return 61===b?w(Ic,61===ob.charCodeAt(tb+2)?3:2):w(61===a?yc:Cc,1)}function u(a){switch(a){case 46:return m();case 40:return++tb,i(qc);case 41:return++tb,i(rc);case 59:return++tb,i(tc);case 44:return++tb,i(sc);case 91:return++tb,i(mc);case 93:return++tb,i(nc);case 123:return++tb,i(oc);case 125:return++tb,i(pc);case 58:return++tb,i(uc);case 63:return++tb,i(wc);case 48:var b=ob.charCodeAt(tb+1);if(120===b||88===b)return z();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return A(!1);case 34:case 39:return B(a);case 47:return n(a);case 37:case 42:return o();case 124:case 38:return p(a);case 94:return q();case 43:case 45:return r(a);case 60:case 62:return s(a);case 61:case 33:return t(a);case 126:return w(Cc,1)}return!1}function v(a){if(ub=tb,nb.locations&&(wb=new g),a)return x();if(tb>=pb)return i(Nb);var b=ob.charCodeAt(tb);if(e(b)||92===b)return E();var d=u(b);if(d===!1){var f=String.fromCharCode(b);if("\\"===f||Wc.test(f))return E();c(tb,"Unexpected character '"+f+"'")}return d}function w(a,b){var c=ob.slice(tb,tb+b);tb+=b,i(a,c)}function x(){for(var a,b,d="",e=tb;;){tb>=pb&&c(e,"Unterminated regular expression");var f=ob.charAt(tb);if(Yc.test(f)&&c(e,"Unterminated regular expression"),a)a=!1;else{if("["===f)b=!0;else if("]"===f&&b)b=!1;else if("/"===f&&!b)break;a="\\"===f}++tb}var d=ob.slice(e,tb);++tb;var g=D();return g&&!/^[gmsiy]*$/.test(g)&&c(e,"Invalid regexp flag"),i(Kb,new RegExp(d,g))}function y(a,b){for(var c=tb,d=0,e=0,f=null==b?1/0:b;f>e;++e){var g,h=ob.charCodeAt(tb);if(g=h>=97?h-97+10:h>=65?h-65+10:h>=48&&57>=h?h-48:1/0,g>=a)break;++tb,d=d*a+g}return tb===c||null!=b&&tb-c!==b?null:d}function z(){tb+=2;var a=y(16);return null==a&&c(ub+2,"Expected hexadecimal number"),e(ob.charCodeAt(tb))&&c(tb,"Identifier directly after number"),i(Jb,a)}function A(a){var b=tb,d=!1,f=48===ob.charCodeAt(tb);a||null!==y(10)||c(b,"Invalid number"),46===ob.charCodeAt(tb)&&(++tb,y(10),d=!0);var g=ob.charCodeAt(tb);(69===g||101===g)&&(g=ob.charCodeAt(++tb),(43===g||45===g)&&++tb,null===y(10)&&c(b,"Invalid number"),d=!0),e(ob.charCodeAt(tb))&&c(tb,"Identifier directly after number");var h,j=ob.slice(b,tb);return d?h=parseFloat(j):f&&1!==j.length?/[89]/.test(j)||Ib?c(b,"Invalid number"):h=parseInt(j,8):h=parseInt(j,10),i(Jb,h)}function B(a){for(tb++,$c.length=0;;){tb>=pb&&c(ub,"Unterminated string constant");var b=ob.charCodeAt(tb);if(b===a)return++tb,i(Lb,String.fromCharCode.apply(null,$c));if(92===b){b=ob.charCodeAt(++tb);var d=/^[0-7]+/.exec(ob.slice(tb,tb+3));for(d&&(d=d[0]);d&&parseInt(d,8)>255;)d=d.slice(0,d.length-1);if("0"===d&&(d=null),++tb,d)Ib&&c(tb-2,"Octal literal in strict mode"),$c.push(parseInt(d,8)),tb+=d.length-1;else switch(b){case 110:$c.push(10);break;case 114:$c.push(13);break;case 120:$c.push(C(2));break;case 117:$c.push(C(4));break;case 85:$c.push(C(8));break;case 116:$c.push(9);break;case 98:$c.push(8);break;case 118:$c.push(11);break;case 102:$c.push(12);break;case 48:$c.push(0);break;case 13:10===ob.charCodeAt(tb)&&++tb;case 10:nb.locations&&(Cb=tb,++Bb);break;default:$c.push(b)}}else(13===b||10===b||8232===b||8329===b)&&c(ub,"Unterminated string constant"),$c.push(b),++tb}}function C(a){var b=y(16,a);return null===b&&c(ub,"Bad character escape sequence"),b}function D(){Nc=!1;for(var a,b=!0,d=tb;;){var g=ob.charCodeAt(tb);if(f(g))Nc&&(a+=ob.charAt(tb)),++tb;else{if(92!==g)break;Nc||(a=ob.slice(d,tb)),Nc=!0,117!=ob.charCodeAt(++tb)&&c(tb,"Expecting Unicode escape sequence \\uXXXX"),++tb;var h=C(4),i=String.fromCharCode(h);i||c(tb-1,"Invalid Unicode escape"),(b?e(h):f(h))||c(tb-4,"Invalid Unicode escape"),a+=i}b=!1}return Nc?a:ob.slice(d,tb)}function E(){var a=D(),b=Mb;return Nc||(Sc(a)?b=lc[a]:(nb.forbidReserved&&(3===nb.ecmaVersion?Oc:Pc)(a)||Ib&&Qc(a))&&c(ub,"The keyword '"+a+"' is reserved")),i(b,a)}function F(){Db=ub,Eb=vb,Fb=xb,v()}function G(a){Ib=a,tb=Eb,l(),v()}function H(){this.type=null,this.start=ub,this.end=null}function I(){this.start=wb,this.end=null,null!==qb&&(this.source=qb)}function J(){var a=new H;return nb.locations&&(a.loc=new I),nb.ranges&&(a.range=[ub,0]),a}function K(a){var b=new H;return b.start=a.start,nb.locations&&(b.loc=new I,b.loc.start=a.loc.start),nb.ranges&&(b.range=[a.range[0],0]),b}function L(a,b){return a.type=b,a.end=Eb,nb.locations&&(a.loc.end=Fb),nb.ranges&&(a.range[1]=Eb),a}function M(a){return nb.ecmaVersion>=5&&"ExpressionStatement"===a.type&&"Literal"===a.expression.type&&"use strict"===a.expression.value}function N(a){return yb===a?(F(),!0):void 0}function O(){return!nb.strictSemicolons&&(yb===Nb||yb===pc||Yc.test(ob.slice(Eb,ub)))}function P(){N(tc)||O()||R()}function Q(a){yb===a?F():R()}function R(){c(ub,"Unexpected token")}function S(a){"Identifier"!==a.type&&"MemberExpression"!==a.type&&c(a.start,"Assigning to rvalue"),Ib&&"Identifier"===a.type&&Rc(a.name)&&c(a.start,"Assigning to "+a.name+" in strict mode")}function T(a){Db=Eb=tb,nb.locations&&(Fb=new g),Gb=Ib=null,Hb=[],v();var b=a||J(),c=!0;for(a||(b.body=[]);yb!==Nb;){var d=U();b.body.push(d),c&&M(d)&&G(!0),c=!1}return L(b,"Program")}function U(){yb===xc&&v(!0);var a=yb,b=J();switch(a){case Ob:case Rb:F();var d=a===Ob;N(tc)||O()?b.label=null:yb!==Mb?R():(b.label=mb(),P());for(var e=0;e<Hb.length;++e){var f=Hb[e];if(null==b.label||f.name===b.label.name){if(null!=f.kind&&(d||"loop"===f.kind))break;if(b.label&&d)break}}return e===Hb.length&&c(b.start,"Unsyntactic "+a.keyword),L(b,d?"BreakStatement":"ContinueStatement");case Sb:return F(),P(),L(b,"DebuggerStatement");case Ub:return F(),Hb.push(_c),b.body=U(),Hb.pop(),Q(dc),b.test=V(),P(),L(b,"DoWhileStatement");case Xb:if(F(),Hb.push(_c),Q(qc),yb===tc)return X(b,null);if(yb===cc){var g=J();return F(),Z(g,!0),1===g.declarations.length&&N(kc)?Y(b,g):X(b,g)}var g=$(!1,!0);return N(kc)?(S(g),Y(b,g)):X(b,g);case Yb:return F(),kb(b,!0);case Zb:return F(),b.test=V(),b.consequent=U(),b.alternate=N(Vb)?U():null,L(b,"IfStatement");case $b:return Gb||c(ub,"'return' outside of function"),F(),N(tc)||O()?b.argument=null:(b.argument=$(),P()),L(b,"ReturnStatement");case _b:F(),b.discriminant=V(),b.cases=[],Q(oc),Hb.push(ad);for(var h,i;yb!=pc;)if(yb===Pb||yb===Tb){var j=yb===Pb;h&&L(h,"SwitchCase"),b.cases.push(h=J()),h.consequent=[],F(),j?h.test=$():(i&&c(Db,"Multiple default clauses"),i=!0,h.test=null),Q(uc)}else h||R(),h.consequent.push(U());return h&&L(h,"SwitchCase"),F(),Hb.pop(),L(b,"SwitchStatement");case ac:return F(),Yc.test(ob.slice(Eb,ub))&&c(Eb,"Illegal newline after throw"),b.argument=$(),P(),L(b,"ThrowStatement");case bc:for(F(),b.block=W(),b.handlers=[];yb===Qb;){var k=J();F(),Q(qc),k.param=mb(),Ib&&Rc(k.param.name)&&c(k.param.start,"Binding "+k.param.name+" in strict mode"),Q(rc),k.guard=null,k.body=W(),b.handlers.push(L(k,"CatchClause"))}return b.finalizer=N(Wb)?W():null,b.handlers.length||b.finalizer||c(b.start,"Missing catch or finally clause"),L(b,"TryStatement");case cc:return F(),b=Z(b),P(),b;case dc:return F(),b.test=V(),Hb.push(_c),b.body=U(),Hb.pop(),L(b,"WhileStatement");case ec:return Ib&&c(ub,"'with' in strict mode"),F(),b.object=V(),b.body=U(),L(b,"WithStatement");case oc:return W();case tc:return F(),L(b,"EmptyStatement");default:var l=zb,m=$();if(a===Mb&&"Identifier"===m.type&&N(uc)){for(var e=0;e<Hb.length;++e)Hb[e].name===l&&c(m.start,"Label '"+l+"' is already declared");var n=yb.isLoop?"loop":yb===_b?"switch":null;return Hb.push({name:l,kind:n}),b.body=U(),Hb.pop(),b.label=m,L(b,"LabeledStatement")}return b.expression=m,P(),L(b,"ExpressionStatement")}}function V(){Q(qc);var a=$();return Q(rc),a}function W(){var a,b=J(),c=!0,d=!1;for(b.body=[],Q(oc);!N(pc);){var e=U();b.body.push(e),c&&M(e)&&(a=d,G(d=!0)),c=!1}return d&&!a&&G(!1),L(b,"BlockStatement")}function X(a,b){return a.init=b,Q(tc),a.test=yb===tc?null:$(),Q(tc),a.update=yb===rc?null:$(),Q(rc),a.body=U(),Hb.pop(),L(a,"ForStatement")}function Y(a,b){return a.left=b,a.right=$(),Q(rc),a.body=U(),Hb.pop(),L(a,"ForInStatement")}function Z(a,b){for(a.declarations=[],a.kind="var";;){var d=J();if(d.id=mb(),Ib&&Rc(d.id.name)&&c(d.id.start,"Binding "+d.id.name+" in strict mode"),d.init=N(yc)?$(!0,b):null,a.declarations.push(L(d,"VariableDeclarator")),!N(sc))break}return L(a,"VariableDeclaration")}function $(a,b){var c=_(b);if(!a&&yb===sc){var d=K(c);for(d.expressions=[c];N(sc);)d.expressions.push(_(b));return L(d,"SequenceExpression")}return c}function _(a){var b=ab(a);if(yb.isAssign){var c=K(b);return c.operator=zb,c.left=b,F(),c.right=_(a),S(b),L(c,"AssignmentExpression")}return b}function ab(a){var b=bb(a);if(N(wc)){var c=K(b);return c.test=b,c.consequent=$(!0),Q(uc),c.alternate=$(!0,a),L(c,"ConditionalExpression")}return b}function bb(a){return cb(db(a),-1,a)}function cb(a,b,c){var d=yb.binop;if(null!=d&&(!c||yb!==kc)&&d>b){var e=K(a);e.left=a,e.operator=zb,F(),e.right=cb(db(c),d,c);var e=L(e,/&&|\|\|/.test(e.operator)?"LogicalExpression":"BinaryExpression");return cb(e,b,c)}return a}function db(a){if(yb.prefix){var b=J(),d=yb.isUpdate;return b.operator=zb,b.prefix=!0,F(),b.argument=db(a),d?S(b.argument):Ib&&"delete"===b.operator&&"Identifier"===b.argument.type&&c(b.start,"Deleting local variable in strict mode"),L(b,d?"UpdateExpression":"UnaryExpression")}for(var e=eb();yb.postfix&&!O();){var b=K(e);b.operator=zb,b.prefix=!1,b.argument=e,S(e),F(),e=L(b,"UpdateExpression")
}return e}function eb(){return fb(gb())}function fb(a,b){if(N(vc)){var c=K(a);return c.object=a,c.property=mb(!0),c.computed=!1,fb(L(c,"MemberExpression"),b)}if(N(mc)){var c=K(a);return c.object=a,c.property=$(),c.computed=!0,Q(nc),fb(L(c,"MemberExpression"),b)}if(!b&&N(qc)){var c=K(a);return c.callee=a,c.arguments=lb(rc,!1),fb(L(c,"CallExpression"),b)}return a}function gb(){switch(yb){case gc:var a=J();return F(),L(a,"ThisExpression");case Mb:return mb();case Jb:case Lb:case Kb:var a=J();return a.value=zb,a.raw=ob.slice(ub,vb),F(),L(a,"Literal");case hc:case ic:case jc:var a=J();return a.value=yb.atomValue,a.raw=yb.keyword,F(),L(a,"Literal");case qc:var b=wb,c=ub;F();var d=$();return d.start=c,d.end=vb,nb.locations&&(d.loc.start=b,d.loc.end=xb),nb.ranges&&(d.range=[c,vb]),Q(rc),d;case mc:var a=J();return F(),a.elements=lb(nc,!0,!0),L(a,"ArrayExpression");case oc:return ib();case Yb:var a=J();return F(),kb(a,!1);case fc:return hb();default:R()}}function hb(){var a=J();return F(),a.callee=fb(gb(),!0),a.arguments=N(qc)?lb(rc,!1):[],L(a,"NewExpression")}function ib(){var a=J(),b=!0,d=!1;for(a.properties=[],F();!N(pc);){if(b)b=!1;else if(Q(sc),nb.allowTrailingCommas&&N(pc))break;var e,f={key:jb()},g=!1;if(N(uc)?(f.value=$(!0),e=f.kind="init"):nb.ecmaVersion>=5&&"Identifier"===f.key.type&&("get"===f.key.name||"set"===f.key.name)?(g=d=!0,e=f.kind=f.key.name,f.key=jb(),yb!==qc&&R(),f.value=kb(J(),!1)):R(),"Identifier"===f.key.type&&(Ib||d))for(var h=0;h<a.properties.length;++h){var i=a.properties[h];if(i.key.name===f.key.name){var j=e==i.kind||g&&"init"===i.kind||"init"===e&&("get"===i.kind||"set"===i.kind);j&&!Ib&&"init"===e&&"init"===i.kind&&(j=!1),j&&c(f.key.start,"Redefinition of property")}}a.properties.push(f)}return L(a,"ObjectExpression")}function jb(){return yb===Jb||yb===Lb?gb():mb(!0)}function kb(a,b){yb===Mb?a.id=mb():b?R():a.id=null,a.params=[];var d=!0;for(Q(qc);!N(rc);)d?d=!1:Q(sc),a.params.push(mb());var e=Gb,f=Hb;if(Gb=!0,Hb=[],a.body=W(!0),Gb=e,Hb=f,Ib||a.body.body.length&&M(a.body.body[0]))for(var g=a.id?-1:0;g<a.params.length;++g){var h=0>g?a.id:a.params[g];if((Qc(h.name)||Rc(h.name))&&c(h.start,"Defining '"+h.name+"' in strict mode"),g>=0)for(var i=0;g>i;++i)h.name===a.params[i].name&&c(h.start,"Argument name clash in strict mode")}return L(a,b?"FunctionDeclaration":"FunctionExpression")}function lb(a,b,c){for(var d=[],e=!0;!N(a);){if(e)e=!1;else if(Q(sc),b&&nb.allowTrailingCommas&&N(a))break;d.push(c&&yb===sc?null:$(!0))}return d}function mb(a){var b=J();return b.name=yb===Mb?zb:a&&!nb.forbidReserved&&yb.keyword||R(),F(),L(b,"Identifier")}a.version="0.1.0";var nb,ob,pb,qb;a.parse=function(a,c){return ob=String(a),pb=ob.length,b(c),h(),T(nb.program)};var rb=a.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},sb=a.getLineInfo=function(a,b){for(var c=1,d=0;;){Zc.lastIndex=d;var e=Zc.exec(a);if(!(e&&e.index<b))break;++c,d=e.index+e[0].length}return{line:c,column:b-d}};a.tokenize=function(a,c){function d(a){return v(a),e.start=ub,e.end=vb,e.startLoc=wb,e.endLoc=xb,e.type=yb,e.value=zb,e}ob=String(a),pb=ob.length,b(c),h();var e={};return d.jumpTo=function(a,b){if(tb=a,nb.locations){Bb=Cb=Zc.lastIndex=0;for(var c;(c=Zc.exec(ob))&&c.index<a;)++Bb,Cb=c.index+c[0].length}ob.charAt(a-1);Ab=b,l()},d};var tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb,Ib,Jb={type:"num"},Kb={type:"regexp"},Lb={type:"string"},Mb={type:"name"},Nb={type:"eof"},Ob={keyword:"break"},Pb={keyword:"case",beforeExpr:!0},Qb={keyword:"catch"},Rb={keyword:"continue"},Sb={keyword:"debugger"},Tb={keyword:"default"},Ub={keyword:"do",isLoop:!0},Vb={keyword:"else",beforeExpr:!0},Wb={keyword:"finally"},Xb={keyword:"for",isLoop:!0},Yb={keyword:"function"},Zb={keyword:"if"},$b={keyword:"return",beforeExpr:!0},_b={keyword:"switch"},ac={keyword:"throw",beforeExpr:!0},bc={keyword:"try"},cc={keyword:"var"},dc={keyword:"while",isLoop:!0},ec={keyword:"with"},fc={keyword:"new",beforeExpr:!0},gc={keyword:"this"},hc={keyword:"null",atomValue:null},ic={keyword:"true",atomValue:!0},jc={keyword:"false",atomValue:!1},kc={keyword:"in",binop:7,beforeExpr:!0},lc={"break":Ob,"case":Pb,"catch":Qb,"continue":Rb,"debugger":Sb,"default":Tb,"do":Ub,"else":Vb,"finally":Wb,"for":Xb,"function":Yb,"if":Zb,"return":$b,"switch":_b,"throw":ac,"try":bc,"var":cc,"while":dc,"with":ec,"null":hc,"true":ic,"false":jc,"new":fc,"in":kc,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":gc,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},mc={type:"[",beforeExpr:!0},nc={type:"]"},oc={type:"{",beforeExpr:!0},pc={type:"}"},qc={type:"(",beforeExpr:!0},rc={type:")"},sc={type:",",beforeExpr:!0},tc={type:";",beforeExpr:!0},uc={type:":",beforeExpr:!0},vc={type:"."},wc={type:"?",beforeExpr:!0},xc={binop:10,beforeExpr:!0},yc={isAssign:!0,beforeExpr:!0},zc={isAssign:!0,beforeExpr:!0},Ac={binop:9,prefix:!0,beforeExpr:!0},Bc={postfix:!0,prefix:!0,isUpdate:!0},Cc={prefix:!0,beforeExpr:!0},Dc={binop:1,beforeExpr:!0},Ec={binop:2,beforeExpr:!0},Fc={binop:3,beforeExpr:!0},Gc={binop:4,beforeExpr:!0},Hc={binop:5,beforeExpr:!0},Ic={binop:6,beforeExpr:!0},Jc={binop:7,beforeExpr:!0},Kc={binop:8,beforeExpr:!0},Lc={binop:10,beforeExpr:!0};a.tokTypes={bracketL:mc,bracketR:nc,braceL:oc,braceR:pc,parenL:qc,parenR:rc,comma:sc,semi:tc,colon:uc,dot:vc,question:wc,slash:xc,eq:yc,name:Mb,eof:Nb,num:Jb,regexp:Kb,string:Lb};for(var Mc in lc)a.tokTypes[Mc]=lc[Mc];var Nc,Oc=d("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Pc=d("class enum extends super const export import"),Qc=d("implements interface let package private protected public static yield"),Rc=d("eval arguments"),Sc=d("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Tc=/[-\u2028\u2029\ufeff]/,Uc="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Vc="------------------------------------------------------------------------------------------------------------------------------------------",Wc=new RegExp("["+Uc+"]"),Xc=new RegExp("["+Uc+Vc+"]"),Yc=/[\n\r\u2028\u2029]/,Zc=/\r\n|[\n\r\u2028\u2029]/g,$c=[],_c={kind:"loop"},ad={kind:"switch"}}("undefined"==typeof c?self.acorn={}:c)},{}],11:[function(require,module,exports){var PEG=function(undefined){function range(a,b){b===undefined&&(b=a,a=0);for(var c=new Array(Math.max(0,b-a)),d=0,e=a;b>e;d++,e++)c[d]=e;return c}function find(a,b){for(var c=a.length,d=0;c>d;d++)if(b(a[d]))return a[d]}function contains(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]===b)return!0;return!1}function each(a,b){for(var c=a.length,d=0;c>d;d++)b(a[d],d)}function map(a,b){for(var c=[],d=a.length,e=0;d>e;e++)c[e]=b(a[e],e);return c}function pluck(a,b){return map(a,function(a){return a[b]})}function keys(a){var b=[];for(var c in a)b.push(c);return b}function values(a){var b=[];for(var c in a)b.push(a[c]);return b}function padLeft(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function escape(a){var b,c,d=a.charCodeAt(0);return 255>=d?(b="x",c=2):(b="u",c=4),"\\"+b+padLeft(d.toString(16).toUpperCase(),"0",c)}function quote(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(//g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[ ---]/g,escape)+'"'}function quoteForRegexpClass(a){return a.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/\]/g,"\\]").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\x0B").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[---]/g,escape)}function buildNodeVisitor(a){return function(b){return a[b.type].apply(null,arguments)}}function findRuleByName(a,b){return find(a.rules,function(a){return a.name===b})}var PEG={VERSION:"0.7.0",buildParser:function(a,b){return PEG.compiler.compile(PEG.parser.parse(a),b)}};return PEG.GrammarError=function(a){this.name="PEG.GrammarError",this.message=a},PEG.GrammarError.prototype=Error.prototype,PEG.parser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(//g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[ ---]/g,escape)+'"'}var b={parse:function(b,c){function d(a){lb>jb||(jb>lb&&(lb=jb,mb=[]),mb.push(a))}function e(){var a,b,c,d,e,h;if(e=jb,h=jb,a=_(),null!==a)if(b=f(),b=null!==b?b:"",null!==b){if(d=g(),null!==d)for(c=[];null!==d;)c.push(d),d=g();else c=null;null!==c?a=[a,b,c]:(a=null,jb=h)}else a=null,jb=h;else a=null,jb=h;return null!==a&&(a=function(a,b,c){return{type:"grammar",initializer:""!==b?b:null,rules:c,startRule:c[0].name}}(e,a[1],a[2])),null===a&&(jb=e),a}function f(){var a,b,c,d;return c=jb,d=jb,a=n(),null!==a?(b=t(),b=null!==b?b:"",null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"initializer",code:b}}(c,a[0])),null===a&&(jb=c),a}function g(){var a,b,c,d,e,f,g;return f=jb,g=jb,a=D(),null!==a?(b=F(),b=null!==b?b:"",null!==b?(c=r(),null!==c?(d=h(),null!==d?(e=t(),e=null!==e?e:"",null!==e?a=[a,b,c,d,e]:(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g),null!==a&&(a=function(a,b,c,d){return{type:"rule",name:b,displayName:""!==c?c:null,expression:d}}(f,a[0],a[1],a[3])),null===a&&(jb=f),a}function h(){var a,b,c,d,e,f,g;if(e=jb,f=jb,a=i(),null!==a){for(b=[],g=jb,c=u(),null!==c?(d=i(),null!==d?c=[c,d]:(c=null,jb=g)):(c=null,jb=g);null!==c;)b.push(c),g=jb,c=u(),null!==c?(d=i(),null!==d?c=[c,d]:(c=null,jb=g)):(c=null,jb=g);null!==b?a=[a,b]:(a=null,jb=f)}else a=null,jb=f;return null!==a&&(a=function(a,b,c){if(c.length>0){var d=[b].concat(map(c,function(a){return a[1]}));return{type:"choice",alternatives:d}}return b}(e,a[0],a[1])),null===a&&(jb=e),a}function i(){var a,b,c,d;for(c=jb,d=jb,a=[],b=j();null!==b;)a.push(b),b=j();if(null!==a?(b=n(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b,c){var d=1!==b.length?{type:"sequence",elements:b}:b[0];return{type:"action",expression:d,code:c}}(c,a[0],a[1])),null===a&&(jb=c),null===a){for(c=jb,a=[],b=j();null!==b;)a.push(b),b=j();null!==a&&(a=function(a,b){return 1!==b.length?{type:"sequence",elements:b}:b[0]}(c,a)),null===a&&(jb=c)}return a}function j(){var a,b,c,d,e;return d=jb,e=jb,a=D(),null!==a?(b=s(),null!==b?(c=k(),null!==c?a=[a,b,c]:(a=null,jb=e)):(a=null,jb=e)):(a=null,jb=e),null!==a&&(a=function(a,b,c){return{type:"labeled",label:b,expression:c}}(d,a[0],a[2])),null===a&&(jb=d),null===a&&(a=k()),a}function k(){var a,b,c,d;return c=jb,d=jb,a=v(),null!==a?(b=n(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"semantic_and",code:b}}(c,a[1])),null===a&&(jb=c),null===a&&(c=jb,d=jb,a=v(),null!==a?(b=l(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"simple_and",expression:b}}(c,a[1])),null===a&&(jb=c),null===a&&(c=jb,d=jb,a=w(),null!==a?(b=n(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"semantic_not",code:b}}(c,a[1])),null===a&&(jb=c),null===a&&(c=jb,d=jb,a=w(),null!==a?(b=l(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"simple_not",expression:b}}(c,a[1])),null===a&&(jb=c),null===a&&(a=l())))),a}function l(){var a,b,c,d;return c=jb,d=jb,a=m(),null!==a?(b=x(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"optional",expression:b}}(c,a[0])),null===a&&(jb=c),null===a&&(c=jb,d=jb,a=m(),null!==a?(b=y(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"zero_or_more",expression:b}}(c,a[0])),null===a&&(jb=c),null===a&&(c=jb,d=jb,a=m(),null!==a?(b=z(),null!==b?a=[a,b]:(a=null,jb=d)):(a=null,jb=d),null!==a&&(a=function(a,b){return{type:"one_or_more",expression:b}}(c,a[0])),null===a&&(jb=c),null===a&&(a=m()))),a}function m(){var a,b,c,d,e,f,g;return d=jb,e=jb,a=D(),null!==a?(f=jb,kb++,g=jb,b=F(),b=null!==b?b:"",null!==b?(c=r(),null!==c?b=[b,c]:(b=null,jb=g)):(b=null,jb=g),kb--,null===b?b="":(b=null,jb=f),null!==b?a=[a,b]:(a=null,jb=e)):(a=null,jb=e),null!==a&&(a=function(a,b){return{type:"rule_ref",name:b}}(d,a[0])),null===a&&(jb=d),null===a&&(a=E(),null===a&&(d=jb,a=C(),null!==a&&(a=function(){return{type:"any"}}(d)),null===a&&(jb=d),null===a&&(a=M(),null===a&&(d=jb,e=jb,a=A(),null!==a?(b=h(),null!==b?(c=B(),null!==c?a=[a,b,c]:(a=null,jb=e)):(a=null,jb=e)):(a=null,jb=e),null!==a&&(a=function(a,b){return b}(d,a[1])),null===a&&(jb=d))))),a}function n(){var a,b,c,e;return kb++,c=jb,e=jb,a=o(),null!==a?(b=_(),null!==b?a=[a,b]:(a=null,jb=e)):(a=null,jb=e),null!==a&&(a=function(a,b){return b.substr(1,b.length-2)}(c,a[0])),null===a&&(jb=c),kb--,0===kb&&null===a&&d("action"),a}function o(){var a,c,e,f,g;if(f=jb,g=jb,123===b.charCodeAt(jb)?(a="{",jb++):(a=null,0===kb&&d('"{"')),null!==a){for(c=[],e=o(),null===e&&(e=q());null!==e;)c.push(e),e=o(),null===e&&(e=q());null!==c?(125===b.charCodeAt(jb)?(e="}",jb++):(e=null,0===kb&&d('"}"')),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)}else a=null,jb=g;return null!==a&&(a=function(a,b){return"{"+b.join("")+"}"}(f,a[1])),null===a&&(jb=f),a}function p(){var a,b,c;if(c=jb,b=q(),null!==b)for(a=[];null!==b;)a.push(b),b=q();else a=null;return null!==a&&(a=function(a,b){return b.join("")}(c,a)),null===a&&(jb=c),a}function q(){var a;return/^[^{}]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[^{}]")),a}function r(){var a,c,e,f;return e=jb,f=jb,61===b.charCodeAt(jb)?(a="=",jb++):(a=null,0===kb&&d('"="')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"="}(e)),null===a&&(jb=e),a}function s(){var a,c,e,f;return e=jb,f=jb,58===b.charCodeAt(jb)?(a=":",jb++):(a=null,0===kb&&d('":"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return":"}(e)),null===a&&(jb=e),a}function t(){var a,c,e,f;return e=jb,f=jb,59===b.charCodeAt(jb)?(a=";",jb++):(a=null,0===kb&&d('";"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return";"}(e)),null===a&&(jb=e),a}function u(){var a,c,e,f;return e=jb,f=jb,47===b.charCodeAt(jb)?(a="/",jb++):(a=null,0===kb&&d('"/"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"/"}(e)),null===a&&(jb=e),a}function v(){var a,c,e,f;return e=jb,f=jb,38===b.charCodeAt(jb)?(a="&",jb++):(a=null,0===kb&&d('"&"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"&"}(e)),null===a&&(jb=e),a}function w(){var a,c,e,f;return e=jb,f=jb,33===b.charCodeAt(jb)?(a="!",jb++):(a=null,0===kb&&d('"!"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"!"}(e)),null===a&&(jb=e),a}function x(){var a,c,e,f;return e=jb,f=jb,63===b.charCodeAt(jb)?(a="?",jb++):(a=null,0===kb&&d('"?"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"?"}(e)),null===a&&(jb=e),a}function y(){var a,c,e,f;return e=jb,f=jb,42===b.charCodeAt(jb)?(a="*",jb++):(a=null,0===kb&&d('"*"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"*"}(e)),null===a&&(jb=e),a}function z(){var a,c,e,f;return e=jb,f=jb,43===b.charCodeAt(jb)?(a="+",jb++):(a=null,0===kb&&d('"+"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"+"}(e)),null===a&&(jb=e),a}function A(){var a,c,e,f;return e=jb,f=jb,40===b.charCodeAt(jb)?(a="(",jb++):(a=null,0===kb&&d('"("')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"("}(e)),null===a&&(jb=e),a}function B(){var a,c,e,f;return e=jb,f=jb,41===b.charCodeAt(jb)?(a=")",jb++):(a=null,0===kb&&d('")"')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return")"}(e)),null===a&&(jb=e),a}function C(){var a,c,e,f;return e=jb,f=jb,46===b.charCodeAt(jb)?(a=".",jb++):(a=null,0===kb&&d('"."')),null!==a?(c=_(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"."}(e)),null===a&&(jb=e),a}function D(){var a,c,e,f,g;if(kb++,f=jb,g=jb,a=Y(),null===a&&(95===b.charCodeAt(jb)?(a="_",jb++):(a=null,0===kb&&d('"_"')),null===a&&(36===b.charCodeAt(jb)?(a="$",jb++):(a=null,0===kb&&d('"$"')))),null!==a){for(c=[],e=Y(),null===e&&(e=W(),null===e&&(95===b.charCodeAt(jb)?(e="_",jb++):(e=null,0===kb&&d('"_"')),null===e&&(36===b.charCodeAt(jb)?(e="$",jb++):(e=null,0===kb&&d('"$"')))));null!==e;)c.push(e),e=Y(),null===e&&(e=W(),null===e&&(95===b.charCodeAt(jb)?(e="_",jb++):(e=null,0===kb&&d('"_"')),null===e&&(36===b.charCodeAt(jb)?(e="$",jb++):(e=null,0===kb&&d('"$"')))));null!==c?(e=_(),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)}else a=null,jb=g;return null!==a&&(a=function(a,b,c){return b+c.join("")}(f,a[0],a[1])),null===a&&(jb=f),kb--,0===kb&&null===a&&d("identifier"),a}function E(){var a,c,e,f,g;return kb++,f=jb,g=jb,a=G(),null===a&&(a=J()),null!==a?(105===b.charCodeAt(jb)?(c="i",jb++):(c=null,0===kb&&d('"i"')),c=null!==c?c:"",null!==c?(e=_(),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g),null!==a&&(a=function(a,b,c){return{type:"literal",value:b,ignoreCase:"i"===c}}(f,a[0],a[1])),null===a&&(jb=f),kb--,0===kb&&null===a&&d("literal"),a}function F(){var a,b,c,e;return kb++,c=jb,e=jb,a=G(),null===a&&(a=J()),null!==a?(b=_(),null!==b?a=[a,b]:(a=null,jb=e)):(a=null,jb=e),null!==a&&(a=function(a,b){return b}(c,a[0])),null===a&&(jb=c),kb--,0===kb&&null===a&&d("string"),a}function G(){var a,c,e,f,g;if(f=jb,g=jb,34===b.charCodeAt(jb)?(a='"',jb++):(a=null,0===kb&&d('"\\""')),null!==a){for(c=[],e=H();null!==e;)c.push(e),e=H();null!==c?(34===b.charCodeAt(jb)?(e='"',jb++):(e=null,0===kb&&d('"\\""')),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)}else a=null,jb=g;return null!==a&&(a=function(a,b){return b.join("")}(f,a[1])),null===a&&(jb=f),a}function H(){var a;return a=I(),null===a&&(a=R(),null===a&&(a=S(),null===a&&(a=T(),null===a&&(a=U(),null===a&&(a=V()))))),a}function I(){var a,c,e,f,g;return e=jb,f=jb,g=jb,kb++,34===b.charCodeAt(jb)?(a='"',jb++):(a=null,0===kb&&d('"\\""')),null===a&&(92===b.charCodeAt(jb)?(a="\\",jb++):(a=null,0===kb&&d('"\\\\"')),null===a&&(a=eb())),kb--,null===a?a="":(a=null,jb=g),null!==a?(b.length>jb?(c=b.charAt(jb),jb++):(c=null,0===kb&&d("any character")),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(a,b){return b}(e,a[1])),null===a&&(jb=e),a}function J(){var a,c,e,f,g;if(f=jb,g=jb,39===b.charCodeAt(jb)?(a="'",jb++):(a=null,0===kb&&d('"\'"')),null!==a){for(c=[],e=K();null!==e;)c.push(e),e=K();null!==c?(39===b.charCodeAt(jb)?(e="'",jb++):(e=null,0===kb&&d('"\'"')),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)}else a=null,jb=g;return null!==a&&(a=function(a,b){return b.join("")}(f,a[1])),null===a&&(jb=f),a}function K(){var a;return a=L(),null===a&&(a=R(),null===a&&(a=S(),null===a&&(a=T(),null===a&&(a=U(),null===a&&(a=V()))))),a}function L(){var a,c,e,f,g;return e=jb,f=jb,g=jb,kb++,39===b.charCodeAt(jb)?(a="'",jb++):(a=null,0===kb&&d('"\'"')),null===a&&(92===b.charCodeAt(jb)?(a="\\",jb++):(a=null,0===kb&&d('"\\\\"')),null===a&&(a=eb())),kb--,null===a?a="":(a=null,jb=g),null!==a?(b.length>jb?(c=b.charAt(jb),jb++):(c=null,0===kb&&d("any character")),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(a,b){return b}(e,a[1])),null===a&&(jb=e),a}function M(){var a,c,e,f,g,h,i,j;if(kb++,i=jb,j=jb,91===b.charCodeAt(jb)?(a="[",jb++):(a=null,0===kb&&d('"["')),null!==a)if(94===b.charCodeAt(jb)?(c="^",jb++):(c=null,0===kb&&d('"^"')),c=null!==c?c:"",null!==c){for(e=[],f=N(),null===f&&(f=O());null!==f;)e.push(f),f=N(),null===f&&(f=O());null!==e?(93===b.charCodeAt(jb)?(f="]",jb++):(f=null,0===kb&&d('"]"')),null!==f?(105===b.charCodeAt(jb)?(g="i",jb++):(g=null,0===kb&&d('"i"')),g=null!==g?g:"",null!==g?(h=_(),null!==h?a=[a,c,e,f,g,h]:(a=null,jb=j)):(a=null,jb=j)):(a=null,jb=j)):(a=null,jb=j)}else a=null,jb=j;else a=null,jb=j;return null!==a&&(a=function(a,b,c,d){var e=map(c,function(a){return a.data}),f="["+b+map(c,function(a){return a.rawText}).join("")+"]"+d;return{type:"class",inverted:"^"===b,ignoreCase:"i"===d,parts:e,rawText:f}}(i,a[1],a[2],a[4])),null===a&&(jb=i),kb--,0===kb&&null===a&&d("character class"),a}function N(){var a,c,e,f,g;return f=jb,g=jb,a=O(),null!==a?(45===b.charCodeAt(jb)?(c="-",jb++):(c=null,0===kb&&d('"-"')),null!==c?(e=O(),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g),null!==a&&(a=function(a,b,c){if(b.data.charCodeAt(0)>c.data.charCodeAt(0))throw new this.SyntaxError("Invalid character range: "+b.rawText+"-"+c.rawText+".");return{data:[b.data,c.data],rawText:b.rawText+"-"+c.rawText}}(f,a[0],a[2])),null===a&&(jb=f),a}function O(){var a,b;return b=jb,a=P(),null!==a&&(a=function(a,b){return{data:b,rawText:quoteForRegexpClass(b)}}(b,a)),null===a&&(jb=b),a}function P(){var a;return a=Q(),null===a&&(a=R(),null===a&&(a=S(),null===a&&(a=T(),null===a&&(a=U(),null===a&&(a=V()))))),a}function Q(){var a,c,e,f,g;return e=jb,f=jb,g=jb,kb++,93===b.charCodeAt(jb)?(a="]",jb++):(a=null,0===kb&&d('"]"')),null===a&&(92===b.charCodeAt(jb)?(a="\\",jb++):(a=null,0===kb&&d('"\\\\"')),null===a&&(a=eb())),kb--,null===a?a="":(a=null,jb=g),null!==a?(b.length>jb?(c=b.charAt(jb),jb++):(c=null,0===kb&&d("any character")),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(a,b){return b}(e,a[1])),null===a&&(jb=e),a}function R(){var a,c,e,f,g,h;return f=jb,g=jb,92===b.charCodeAt(jb)?(a="\\",jb++):(a=null,0===kb&&d('"\\\\"')),null!==a?(h=jb,kb++,c=W(),null===c&&(120===b.charCodeAt(jb)?(c="x",jb++):(c=null,0===kb&&d('"x"')),null===c&&(117===b.charCodeAt(jb)?(c="u",jb++):(c=null,0===kb&&d('"u"')),null===c&&(c=eb()))),kb--,null===c?c="":(c=null,jb=h),null!==c?(b.length>jb?(e=b.charAt(jb),jb++):(e=null,0===kb&&d("any character")),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g),null!==a&&(a=function(a,b){return b.replace("b","\b").replace("f","\f").replace("n","\n").replace("r","\r").replace("t","	").replace("v","")}(f,a[2])),null===a&&(jb=f),a}function S(){var a,c,e,f,g;return e=jb,f=jb,"\\0"===b.substr(jb,2)?(a="\\0",jb+=2):(a=null,0===kb&&d('"\\\\0"')),null!==a?(g=jb,kb++,c=W(),kb--,null===c?c="":(c=null,jb=g),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(){return"\x00"}(e)),null===a&&(jb=e),a}function T(){var a,c,e,f,g;return f=jb,g=jb,"\\x"===b.substr(jb,2)?(a="\\x",jb+=2):(a=null,0===kb&&d('"\\\\x"')),null!==a?(c=X(),null!==c?(e=X(),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)):(a=null,jb=g),null!==a&&(a=function(a,b,c){return String.fromCharCode(parseInt(b+c,16))}(f,a[1],a[2])),null===a&&(jb=f),a}function U(){var a,c,e,f,g,h,i;return h=jb,i=jb,"\\u"===b.substr(jb,2)?(a="\\u",jb+=2):(a=null,0===kb&&d('"\\\\u"')),null!==a?(c=X(),null!==c?(e=X(),null!==e?(f=X(),null!==f?(g=X(),null!==g?a=[a,c,e,f,g]:(a=null,jb=i)):(a=null,jb=i)):(a=null,jb=i)):(a=null,jb=i)):(a=null,jb=i),null!==a&&(a=function(a,b,c,d,e){return String.fromCharCode(parseInt(b+c+d+e,16))}(h,a[1],a[2],a[3],a[4])),null===a&&(jb=h),a}function V(){var a,c,e,f;return e=jb,f=jb,92===b.charCodeAt(jb)?(a="\\",jb++):(a=null,0===kb&&d('"\\\\"')),null!==a?(c=db(),null!==c?a=[a,c]:(a=null,jb=f)):(a=null,jb=f),null!==a&&(a=function(a,b){return b}(e,a[1])),null===a&&(jb=e),a}function W(){var a;return/^[0-9]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[0-9]")),a}function X(){var a;return/^[0-9a-fA-F]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[0-9a-fA-F]")),a}function Y(){var a;return a=Z(),null===a&&(a=$()),a}function Z(){var a;return/^[a-z]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[a-z]")),a}function $(){var a;return/^[A-Z]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[A-Z]")),a}function _(){var a,b;for(a=[],b=fb(),null===b&&(b=db(),null===b&&(b=ab()));null!==b;)a.push(b),b=fb(),null===b&&(b=db(),null===b&&(b=ab()));return a}function ab(){var a;return kb++,a=bb(),null===a&&(a=cb()),kb--,0===kb&&null===a&&d("comment"),a}function bb(){var a,c,e,f,g,h,i;if(g=jb,"//"===b.substr(jb,2)?(a="//",jb+=2):(a=null,0===kb&&d('"//"')),null!==a){for(c=[],h=jb,i=jb,kb++,e=eb(),kb--,null===e?e="":(e=null,jb=i),null!==e?(b.length>jb?(f=b.charAt(jb),jb++):(f=null,0===kb&&d("any character")),null!==f?e=[e,f]:(e=null,jb=h)):(e=null,jb=h);null!==e;)c.push(e),h=jb,i=jb,kb++,e=eb(),kb--,null===e?e="":(e=null,jb=i),null!==e?(b.length>jb?(f=b.charAt(jb),jb++):(f=null,0===kb&&d("any character")),null!==f?e=[e,f]:(e=null,jb=h)):(e=null,jb=h);null!==c?a=[a,c]:(a=null,jb=g)}else a=null,jb=g;return a}function cb(){var a,c,e,f,g,h,i;if(g=jb,"/*"===b.substr(jb,2)?(a="/*",jb+=2):(a=null,0===kb&&d('"/*"')),null!==a){for(c=[],h=jb,i=jb,kb++,"*/"===b.substr(jb,2)?(e="*/",jb+=2):(e=null,0===kb&&d('"*/"')),kb--,null===e?e="":(e=null,jb=i),null!==e?(b.length>jb?(f=b.charAt(jb),jb++):(f=null,0===kb&&d("any character")),null!==f?e=[e,f]:(e=null,jb=h)):(e=null,jb=h);null!==e;)c.push(e),h=jb,i=jb,kb++,"*/"===b.substr(jb,2)?(e="*/",jb+=2):(e=null,0===kb&&d('"*/"')),kb--,null===e?e="":(e=null,jb=i),null!==e?(b.length>jb?(f=b.charAt(jb),jb++):(f=null,0===kb&&d("any character")),null!==f?e=[e,f]:(e=null,jb=h)):(e=null,jb=h);null!==c?("*/"===b.substr(jb,2)?(e="*/",jb+=2):(e=null,0===kb&&d('"*/"')),null!==e?a=[a,c,e]:(a=null,jb=g)):(a=null,jb=g)}else a=null,jb=g;return a}function db(){var a;return kb++,10===b.charCodeAt(jb)?(a="\n",jb++):(a=null,0===kb&&d('"\\n"')),null===a&&("\r\n"===b.substr(jb,2)?(a="\r\n",jb+=2):(a=null,0===kb&&d('"\\r\\n"')),null===a&&(13===b.charCodeAt(jb)?(a="\r",jb++):(a=null,0===kb&&d('"\\r"')),null===a&&(8232===b.charCodeAt(jb)?(a="\u2028",jb++):(a=null,0===kb&&d('"\\u2028"')),null===a&&(8233===b.charCodeAt(jb)?(a="\u2029",jb++):(a=null,0===kb&&d('"\\u2029"')))))),kb--,0===kb&&null===a&&d("end of line"),a}function eb(){var a;return/^[\n\r\u2028\u2029]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[\\n\\r\\u2028\\u2029]")),a}function fb(){var a;return kb++,/^[ \t\f\uFEFF-]/.test(b.charAt(jb))?(a=b.charAt(jb),jb++):(a=null,0===kb&&d("[ \\t\\x0B\\f\\xA0\\uFEFF\\u1680\\u180E\\u2000-\\u200A\\u202F\\u205F\\u3000]")),kb--,0===kb&&null===a&&d("whitespace"),a}function gb(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function hb(){for(var a=1,c=1,d=!1,e=0;e<Math.max(jb,lb);e++){var f=b.charAt(e);"\n"===f?(d||a++,c=1,d=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(a++,c=1,d=!0):(c++,d=!1)}return{line:a,column:c}}var ib={grammar:e,initializer:f,rule:g,choice:h,sequence:i,labeled:j,prefixed:k,suffixed:l,primary:m,action:n,braced:o,nonBraceCharacters:p,nonBraceCharacter:q,equals:r,colon:s,semicolon:t,slash:u,and:v,not:w,question:x,star:y,plus:z,lparen:A,rparen:B,dot:C,identifier:D,literal:E,string:F,doubleQuotedString:G,doubleQuotedCharacter:H,simpleDoubleQuotedCharacter:I,singleQuotedString:J,singleQuotedCharacter:K,simpleSingleQuotedCharacter:L,"class":M,classCharacterRange:N,classCharacter:O,bracketDelimitedCharacter:P,simpleBracketDelimitedCharacter:Q,simpleEscapeSequence:R,zeroEscapeSequence:S,hexEscapeSequence:T,unicodeEscapeSequence:U,eolEscapeSequence:V,digit:W,hexDigit:X,letter:Y,lowerCaseLetter:Z,upperCaseLetter:$,__:_,comment:ab,singleLineComment:bb,multiLineComment:cb,eol:db,eolChar:eb,whitespace:fb};if(c!==undefined){if(ib[c]===undefined)throw new Error("Invalid rule name: "+a(c)+".")}else c="grammar";var jb=0,kb=0,lb=0,mb=[],nb=ib[c]();if(null===nb||jb!==b.length){var ob=Math.max(jb,lb),pb=ob<b.length?b.charAt(ob):null,qb=hb();throw new this.SyntaxError(gb(mb),pb,ob,qb.line,qb.column)}return nb},toSource:function(){return this._source}};return b.SyntaxError=function(b,c,d,e,f){function g(b,c){var d,e;switch(b.length){case 0:d="end of input";break;case 1:d=b[0];break;default:d=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}return e=c?a(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=b,this.found=c,this.message=g(b,c),this.offset=d,this.line=e,this.column=f},b.SyntaxError.prototype=Error.prototype,b}(),PEG.compiler={appliedPassNames:["reportMissingRules","reportLeftRecursion","removeProxyRules","computeVarNames","computeParams"],compile:function(ast,options){var that=this;each(this.appliedPassNames,function(a){that.passes[a](ast)});var source=this.emitter(ast,options),result=eval(source);return result._source=source,result}},PEG.compiler.passes={reportMissingRules:function(a){function b(){}function c(a){e(a.expression)}function d(a){return function(b){each(b[a],e)}}var e=buildNodeVisitor({grammar:d("rules"),rule:c,choice:d("alternatives"),sequence:d("elements"),labeled:c,simple_and:c,simple_not:c,semantic_and:b,semantic_not:b,optional:c,zero_or_more:c,one_or_more:c,action:c,rule_ref:function(b){if(!findRuleByName(a,b.name))throw new PEG.GrammarError('Referenced rule "'+b.name+'" does not exist.')},literal:b,any:b,"class":b});e(a)},reportLeftRecursion:function(a){function b(){}function c(a,b){e(a.expression,b)}function d(a){return function(b,c){each(b[a],function(a){e(a,c)})}}var e=buildNodeVisitor({grammar:d("rules"),rule:function(a,b){e(a.expression,b.concat(a.name))},choice:d("alternatives"),sequence:function(a,b){a.elements.length>0&&e(a.elements[0],b)},labeled:c,simple_and:c,simple_not:c,semantic_and:b,semantic_not:b,optional:c,zero_or_more:c,one_or_more:c,action:c,rule_ref:function(b,c){if(contains(c,b.name))throw new PEG.GrammarError('Left recursion detected for rule "'+b.name+'".');e(findRuleByName(a,b.name),c)},literal:b,any:b,"class":b});e(a,[])},removeProxyRules:function(a){function b(a){return"rule"===a.type&&"rule_ref"===a.expression.type}function c(a,b,c){function d(){}function e(a,b,c){g(a.expression,b,c)}function f(a){return function(b,c,d){each(b[a],function(a){g(a,c,d)})}}var g=buildNodeVisitor({grammar:f("rules"),rule:e,choice:f("alternatives"),sequence:f("elements"),labeled:e,simple_and:e,simple_not:e,semantic_and:d,semantic_not:d,optional:e,zero_or_more:e,one_or_more:e,action:e,rule_ref:function(a,b,c){a.name===b&&(a.name=c)},literal:d,any:d,"class":d});g(a,b,c)}var d=[];each(a.rules,function(e,f){b(e)&&(c(a,e.name,e.expression.name),e.name===a.startRule&&(a.startRule=e.expression.name),d.push(f))}),d.reverse(),each(d,function(b){a.rules.splice(b,1)})},computeVarNames:function(a){function b(a){return"result"+a}function c(a){return"pos"+a}function d(a,c){return a.resultVar=b(c.result),{result:0,pos:0}}function e(a){return function(d,e){var g=f(d.expression,{result:e.result+a.result,pos:e.pos+a.pos});
return d.resultVar=b(e.result),0!==a.pos&&(d.posVar=c(e.pos)),{result:g.result+a.result,pos:g.pos+a.pos}}}var f=buildNodeVisitor({grammar:function(a,b){each(a.rules,function(a){f(a,b)})},rule:function(a,d){var e=f(a.expression,d);a.resultVar=b(d.result),a.resultVars=map(range(e.result+1),b),a.posVars=map(range(e.pos),c)},choice:function(a,c){var d=map(a.alternatives,function(a){return f(a,c)});return a.resultVar=b(c.result),{result:Math.max.apply(null,pluck(d,"result")),pos:Math.max.apply(null,pluck(d,"pos"))}},sequence:function(a,d){var e=map(a.elements,function(a,b){return f(a,{result:d.result+b,pos:d.pos+1})});return a.resultVar=b(d.result),a.posVar=c(d.pos),{result:a.elements.length>0?Math.max.apply(null,map(e,function(a,b){return b+a.result})):0,pos:a.elements.length>0?1+Math.max.apply(null,pluck(e,"pos")):1}},labeled:e({result:0,pos:0}),simple_and:e({result:0,pos:1}),simple_not:e({result:0,pos:1}),semantic_and:d,semantic_not:d,optional:e({result:0,pos:0}),zero_or_more:e({result:1,pos:0}),one_or_more:e({result:1,pos:0}),action:e({result:0,pos:1}),rule_ref:d,literal:d,any:d,"class":d});f(a,{result:0,pos:0})},computeParams:function(a){function b(a){f.push({}),a(),f.pop()}function c(){}function d(a){b(function(){g(a.expression)})}function e(a){var b,c=f[f.length-1],d={};for(b in c)d[b]=c[b];a.params=d}var f=[],g=buildNodeVisitor({grammar:function(a){each(a.rules,g)},rule:d,choice:function(a){b(function(){each(a.alternatives,g)})},sequence:function(a){function b(b){each(pluck(a.elements,"resultVar"),function(c,e){new RegExp("^"+c+"(\\[\\d+\\])*$").test(d[b])&&(d[b]=a.resultVar+"["+e+"]"+d[b].substr(c.length))})}var c,d=f[f.length-1];each(a.elements,g);for(c in d)b(c)},labeled:function(a){f[f.length-1][a.label]=a.resultVar,b(function(){g(a.expression)})},simple_and:d,simple_not:d,semantic_and:e,semantic_not:e,optional:d,zero_or_more:d,one_or_more:d,action:function(a){b(function(){g(a.expression),e(a)})},rule_ref:c,literal:c,any:c,"class":c});g(a)}},PEG.compiler.emitter=function(a,b){function c(a,c){return c.string=quote,c.pluck=pluck,c.keys=keys,c.values=values,c.emit=g,c.options=b,b.trackLineAndColumn?(c.posInit=function(a){return"var "+a+" = { offset: 0, line: 1, column: 1, seenCR: false }"},c.posClone=function(a){return"clone("+a+")"},c.posOffset=function(a){return a+".offset"},c.posAdvance=function(a){return"advance(pos, "+a+")"}):(c.posInit=function(a){return"var "+a+" = 0"},c.posClone=function(a){return a},c.posOffset=function(a){return a},c.posAdvance=function(a){return 1===a?"pos++":"pos += "+a}),c.posSave=function(a){return a.posVar+" = "+c.posClone("pos")},c.posRestore=function(a){return"pos = "+c.posClone(a.posVar)},f[a](c)}function d(a){return function(b){return c(a,{node:b})}}b=b||{},b.cache===undefined&&(b.cache=!1),b.trackLineAndColumn===undefined&&(b.trackLineAndColumn=!1);var e=function(a){function b(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(//g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[ -]/g,function(a){return"\\x0"+b(a)}).replace(/[--]/g,function(a){return"\\x"+b(a)}).replace(/[-]/g,function(a){return"\\u0"+b(a)}).replace(/[-]/g,function(a){return"\\u"+b(a)})}function c(a){return"__p.push("+a+");"}function d(a,d,e){function f(a,b,c){return a.replace(new RegExp("^.{"+b+"}","gm"),function(a,b){return 0===b?c?"":a:""})}var g=b(f(a.substring(0,d),e.indentLevel(),e.atBOL));return g.length>0?c('"'+g+'"'):""}var e={VERSION:"1.1.0",indentStep:2,commands:{"if":{params:/^(.*)$/,compile:function(a,b,c){return["if("+c[0]+"){",[]]},stackOp:"push"},"else":{params:/^$/,compile:function(a){var b=a.commandStack,c="else"===b[b.length-1],d="if"===b[b.length-1];if(c)throw new Error("Multiple #elses.");if(!d)throw new Error("Using #else outside of #if.");return["}else{",[]]},stackOp:"replace"},"for":{params:/^([a-zA-Z_][a-zA-Z0-9_]*)[ \t]+in[ \t]+(.*)$/,init:function(a){a.forCurrLevel=0,a.forMaxLevel=0},compile:function(a,b,c){var d="__c"+a.forCurrLevel,e="__l"+a.forCurrLevel,f="__i"+a.forCurrLevel;return a.forCurrLevel++,a.forMaxLevel<a.forCurrLevel&&(a.forMaxLevel=a.forCurrLevel),[d+"="+c[1]+";"+e+"="+d+".length;for("+f+"=0;"+f+"<"+e+";"+f+"++){"+c[0]+"="+d+"["+f+"];",[c[0],d,e,f]]},exit:function(a){a.forCurrLevel--},stackOp:"push"},end:{params:/^$/,compile:function(a){var b,c=a.commandStack;if(0===c.length)throw new Error("Too many #ends.");return b=e.commands[c[c.length-1]].exit,b&&b(a),["}",[]]},stackOp:"pop"},block:{params:/^(.*)$/,compile:function(a,d,e){var f="__x",g="__n",h="__l",i="__i";return[f+'="'+b(d.substring(a.indentLevel()))+'";'+g+"=("+e[0]+').toString().split("\\n");'+h+"="+g+".length;for("+i+"=0;"+i+"<"+h+";"+i+"++){"+g+"["+i+"]="+f+"+"+g+"["+i+']+"\\n";}'+c(g+'.join("")'),[f,g,h,i]]},stackOp:"nop"}},template:function(b){function f(a,b){return a.atBOL=!1,[c(b),[]]}function g(a,b,c,d){var f,g,h;if(f=e.commands[c],!f)throw new Error("Unknown command: #"+c+".");if(g=f.params.exec(d),null===g)throw new Error("Invalid params for command #"+c+": "+d+".");return h=f.compile(a,b,g.slice(1)),l[f.stackOp](a.commandStack,c),a.atBOL=!0,h}var h,i,j,k,l={push:function(a,b){a.push(b)},replace:function(a,b){a[a.length-1]=b},pop:function(a){a.pop()},nop:function(){}},m={commandStack:[],atBOL:!0,indentLevel:function(){return e.indentStep*this.commandStack.length}},n="",o=["__p=[]"];for(h in e.commands)e.commands[h].init&&e.commands[h].init(m);for(;null!==(i=/^([ \t]*)#([a-zA-Z_][a-zA-Z0-9_]*)(?:[ \t]+([^ \t\n][^\n]*))?[ \t]*(?:\n|$)|#\{([^}]*)\}/m.exec(b));)n+=d(b,i.index,m),j=i[2]!==a&&""!==i[2]?g(m,i[1],i[2],i[3]||""):f(m,i[4]),n+=j[0],o=o.concat(j[1]),b=b.substring(i.index+i[0].length);if(n+=d(b,b.length,m),m.commandStack.length>0)throw new Error("Missing #end.");for(o.sort(),k=0;k<o.length;k++)o[k]===o[k-1]&&o.splice(k--,1);return new Function("__v",["__v=__v||{};","var "+o.join(",")+";","with(__v){",n,'return __p.join("").replace(/^\\n+|\\n+$/g,"");};'].join(""))}};return e}(),f=function(){var a,b={},c={grammar:["(function(){","  /*","   * Generated by PEG.js 0.7.0.","   *","   * http://pegjs.majda.cz/","   */","  ","  function quote(s) {","    /*","     * ECMA-262, 5th ed., 7.8.4: All characters may appear literally in a","     * string literal except for the closing quote character, backslash,","     * carriage return, line separator, paragraph separator, and line feed.","     * Any character may appear in the form of an escape sequence.","     *","     * For portability, we also escape escape all control and non-ASCII",'     * characters. Note that "\\0" and "\\v" escape sequences are not used',"     * because JSHint does not like the first and IE the second.","     */","     return '\"' + s","      .replace(/\\\\/g, '\\\\\\\\')  // backslash","      .replace(/\"/g, '\\\\\"')    // closing quote character","      .replace(/\\x08/g, '\\\\b') // backspace","      .replace(/\\t/g, '\\\\t')   // horizontal tab","      .replace(/\\n/g, '\\\\n')   // line feed","      .replace(/\\f/g, '\\\\f')   // form feed","      .replace(/\\r/g, '\\\\r')   // carriage return","      .replace(/[\\x00-\\x07\\x0B\\x0E-\\x1F\\x80-\\uFFFF]/g, escape)","      + '\"';","  }","  ","  var result = {","    /*","     * Parses the input with a generated parser. If the parsing is successfull,","     * returns a value explicitly or implicitly specified by the grammar from","     * which the parser was generated (see |PEG.buildParser|). If the parsing is","     * unsuccessful, throws |PEG.parser.SyntaxError| describing the error.","     */","    parse: function(input, startRule) {","      var parseFunctions = {","        #for rule in node.rules",'          #{string(rule.name) + ": parse_" + rule.name + (rule !== node.rules[node.rules.length - 1] ? "," : "")}',"        #end","      };","      ","      if (startRule !== undefined) {","        if (parseFunctions[startRule] === undefined) {",'          throw new Error("Invalid rule name: " + quote(startRule) + ".");',"        }","      } else {","        startRule = #{string(node.startRule)};","      }","      ",'      #{posInit("pos")};',"      var reportFailures = 0;",'      #{posInit("rightmostFailuresPos")};',"      var rightmostFailuresExpected = [];","      #if options.cache","        var cache = {};","      #end","      ","      function padLeft(input, padding, length) {","        var result = input;","        ","        var padLength = length - input.length;","        for (var i = 0; i < padLength; i++) {","          result = padding + result;","        }","        ","        return result;","      }","      ","      function escape(ch) {","        var charCode = ch.charCodeAt(0);","        var escapeChar;","        var length;","        ","        if (charCode <= 0xFF) {","          escapeChar = 'x';","          length = 2;","        } else {","          escapeChar = 'u';","          length = 4;","        }","        ","        return '\\\\' + escapeChar + padLeft(charCode.toString(16).toUpperCase(), '0', length);","      }","      ","      #if options.trackLineAndColumn","        function clone(object) {","          var result = {};","          for (var key in object) {","            result[key] = object[key];","          }","          return result;","        }","        ","        function advance(pos, n) {","          var endOffset = pos.offset + n;","          ","          for (var offset = pos.offset; offset < endOffset; offset++) {","            var ch = input.charAt(offset);",'            if (ch === "\\n") {',"              if (!pos.seenCR) { pos.line++; }","              pos.column = 1;","              pos.seenCR = false;",'            } else if (ch === "\\r" || ch === "\\u2028" || ch === "\\u2029") {',"              pos.line++;","              pos.column = 1;","              pos.seenCR = true;","            } else {","              pos.column++;","              pos.seenCR = false;","            }","          }","          ","          pos.offset += n;","        }","        ","      #end","      function matchFailed(failure) {",'        if (#{posOffset("pos")} < #{posOffset("rightmostFailuresPos")}) {',"          return;","        }","        ",'        if (#{posOffset("pos")} > #{posOffset("rightmostFailuresPos")}) {','          rightmostFailuresPos = #{posClone("pos")};',"          rightmostFailuresExpected = [];","        }","        ","        rightmostFailuresExpected.push(failure);","      }","      ","      #for rule in node.rules","        #block emit(rule)","        ","      #end","      ","      function cleanupExpected(expected) {","        expected.sort();","        ","        var lastExpected = null;","        var cleanExpected = [];","        for (var i = 0; i < expected.length; i++) {","          if (expected[i] !== lastExpected) {","            cleanExpected.push(expected[i]);","            lastExpected = expected[i];","          }","        }","        return cleanExpected;","      }","      ","      #if !options.trackLineAndColumn","        function computeErrorPosition() {","          /*","           * The first idea was to use |String.split| to break the input up to the","           * error position along newlines and derive the line and column from","           * there. However IE's |split| implementation is so broken that it was","           * enough to prevent it.","           */","          ","          var line = 1;","          var column = 1;","          var seenCR = false;","          ","          for (var i = 0; i < Math.max(pos, rightmostFailuresPos); i++) {","            var ch = input.charAt(i);",'            if (ch === "\\n") {',"              if (!seenCR) { line++; }","              column = 1;","              seenCR = false;",'            } else if (ch === "\\r" || ch === "\\u2028" || ch === "\\u2029") {',"              line++;","              column = 1;","              seenCR = true;","            } else {","              column++;","              seenCR = false;","            }","          }","          ","          return { line: line, column: column };","        }","      #end","      ","      #if node.initializer","        #block emit(node.initializer)","      #end","      ","      var result = parseFunctions[startRule]();","      ","      /*","       * The parser is now in one of the following three states:","       *","       * 1. The parser successfully parsed the whole input.","       *","       *    - |result !== null|",'       *    - |#{posOffset("pos")} === input.length|',"       *    - |rightmostFailuresExpected| may or may not contain something","       *","       * 2. The parser successfully parsed only a part of the input.","       *","       *    - |result !== null|",'       *    - |#{posOffset("pos")} < input.length|',"       *    - |rightmostFailuresExpected| may or may not contain something","       *","       * 3. The parser did not successfully parse any part of the input.","       *","       *   - |result === null|",'       *   - |#{posOffset("pos")} === 0|',"       *   - |rightmostFailuresExpected| contains at least one failure","       *","       * All code following this comment (including called functions) must","       * handle these states.","       */",'      if (result === null || #{posOffset("pos")} !== input.length) {','        var offset = Math.max(#{posOffset("pos")}, #{posOffset("rightmostFailuresPos")});',"        var found = offset < input.length ? input.charAt(offset) : null;","        #if options.trackLineAndColumn",'          var errorPosition = #{posOffset("pos")} > #{posOffset("rightmostFailuresPos")} ? pos : rightmostFailuresPos;',"        #else","          var errorPosition = computeErrorPosition();","        #end","        ","        throw new this.SyntaxError(","          cleanupExpected(rightmostFailuresExpected),","          found,","          offset,","          errorPosition.line,","          errorPosition.column","        );","      }","      ","      return result;","    },","    ","    /* Returns the parser source code. */","    toSource: function() { return this._source; }","  };","  ","  /* Thrown when a parser encounters a syntax error. */","  ","  result.SyntaxError = function(expected, found, offset, line, column) {","    function buildMessage(expected, found) {","      var expectedHumanized, foundHumanized;","      ","      switch (expected.length) {","        case 0:",'          expectedHumanized = "end of input";',"          break;","        case 1:","          expectedHumanized = expected[0];","          break;","        default:",'          expectedHumanized = expected.slice(0, expected.length - 1).join(", ")','            + " or "',"            + expected[expected.length - 1];","      }","      ",'      foundHumanized = found ? quote(found) : "end of input";',"      ",'      return "Expected " + expectedHumanized + " but " + foundHumanized + " found.";',"    }","    ",'    this.name = "SyntaxError";',"    this.expected = expected;","    this.found = found;","    this.message = buildMessage(expected, found);","    this.offset = offset;","    this.line = line;","    this.column = column;","  };","  ","  result.SyntaxError.prototype = Error.prototype;","  ","  return result;","})()"],rule:["function parse_#{node.name}() {","  #if options.cache",'    var cacheKey = "#{node.name}@" + #{posOffset("pos")};',"    var cachedResult = cache[cacheKey];","    if (cachedResult) {",'      pos = #{posClone("cachedResult.nextPos")};',"      return cachedResult.result;","    }","    ","  #end","  #if node.resultVars.length > 0",'    var #{node.resultVars.join(", ")};',"  #end","  #if node.posVars.length > 0",'    var #{node.posVars.join(", ")};',"  #end","  ","  #if node.displayName !== null","    reportFailures++;","  #end","  #block emit(node.expression)","  #if node.displayName !== null","    reportFailures--;","    if (reportFailures === 0 && #{node.resultVar} === null) {","      matchFailed(#{string(node.displayName)});","    }","  #end","  #if options.cache","    ","    cache[cacheKey] = {",'      nextPos: #{posClone("pos")},',"      result:  #{node.resultVar}","    };","  #end","  return #{node.resultVar};","}"],choice:["#block emit(alternative)","#block nextAlternativesCode"],"choice.next":["if (#{node.resultVar} === null) {","  #block code","}"],sequence:["#{posSave(node)};","#block code"],"sequence.iteration":["#block emit(element)","if (#{element.resultVar} !== null) {","  #block code","} else {","  #{node.resultVar} = null;","  #{posRestore(node)};","}"],"sequence.inner":['#{node.resultVar} = [#{pluck(node.elements, "resultVar").join(", ")}];'],simple_and:["#{posSave(node)};","reportFailures++;","#block emit(node.expression)","reportFailures--;","if (#{node.resultVar} !== null) {",'  #{node.resultVar} = "";',"  #{posRestore(node)};","} else {","  #{node.resultVar} = null;","}"],simple_not:["#{posSave(node)};","reportFailures++;","#block emit(node.expression)","reportFailures--;","if (#{node.resultVar} === null) {",'  #{node.resultVar} = "";',"} else {","  #{node.resultVar} = null;","  #{posRestore(node)};","}"],semantic_and:['#{node.resultVar} = (function(#{(options.trackLineAndColumn ? ["offset", "line", "column"] : ["offset"]).concat(keys(node.params)).join(", ")}) {#{node.code}})(#{(options.trackLineAndColumn ? ["pos.offset", "pos.line", "pos.column"] : ["pos"]).concat(values(node.params)).join(", ")}) ? "" : null;'],semantic_not:['#{node.resultVar} = (function(#{(options.trackLineAndColumn ? ["offset", "line", "column"] : ["offset"]).concat(keys(node.params)).join(", ")}) {#{node.code}})(#{(options.trackLineAndColumn ? ["pos.offset", "pos.line", "pos.column"] : ["pos"]).concat(values(node.params)).join(", ")}) ? null : "";'],optional:["#block emit(node.expression)",'#{node.resultVar} = #{node.resultVar} !== null ? #{node.resultVar} : "";'],zero_or_more:["#{node.resultVar} = [];","#block emit(node.expression)","while (#{node.expression.resultVar} !== null) {","  #{node.resultVar}.push(#{node.expression.resultVar});","  #block emit(node.expression)","}"],one_or_more:["#block emit(node.expression)","if (#{node.expression.resultVar} !== null) {","  #{node.resultVar} = [];","  while (#{node.expression.resultVar} !== null) {","    #{node.resultVar}.push(#{node.expression.resultVar});","    #block emit(node.expression)","  }","} else {","  #{node.resultVar} = null;","}"],action:["#{posSave(node)};","#block emit(node.expression)","if (#{node.resultVar} !== null) {",'  #{node.resultVar} = (function(#{(options.trackLineAndColumn ? ["offset", "line", "column"] : ["offset"]).concat(keys(node.params)).join(", ")}) {#{node.code}})(#{(options.trackLineAndColumn ? [node.posVar + ".offset", node.posVar + ".line", node.posVar + ".column"] : [node.posVar]).concat(values(node.params)).join(", ")});',"}","if (#{node.resultVar} === null) {","  #{posRestore(node)};","}"],rule_ref:["#{node.resultVar} = parse_#{node.name}();"],literal:["#if node.value.length === 0",'  #{node.resultVar} = "";',"#else","  #if !node.ignoreCase","    #if node.value.length === 1",'      if (input.charCodeAt(#{posOffset("pos")}) === #{node.value.charCodeAt(0)}) {',"    #else",'      if (input.substr(#{posOffset("pos")}, #{node.value.length}) === #{string(node.value)}) {',"    #end","  #else",'    if (input.substr(#{posOffset("pos")}, #{node.value.length}).toLowerCase() === #{string(node.value.toLowerCase())}) {',"  #end","    #if !node.ignoreCase","      #{node.resultVar} = #{string(node.value)};","    #else",'      #{node.resultVar} = input.substr(#{posOffset("pos")}, #{node.value.length});',"    #end","    #{posAdvance(node.value.length)};","  } else {","    #{node.resultVar} = null;","    if (reportFailures === 0) {","      matchFailed(#{string(string(node.value))});","    }","  }","#end"],any:['if (input.length > #{posOffset("pos")}) {','  #{node.resultVar} = input.charAt(#{posOffset("pos")});',"  #{posAdvance(1)};","} else {","  #{node.resultVar} = null;","  if (reportFailures === 0) {",'    matchFailed("any character");',"  }","}"],"class":['if (#{regexp}.test(input.charAt(#{posOffset("pos")}))) {','  #{node.resultVar} = input.charAt(#{posOffset("pos")});',"  #{posAdvance(1)};","} else {","  #{node.resultVar} = null;","  if (reportFailures === 0) {","    matchFailed(#{string(node.rawText)});","  }","}"]};for(a in c)b[a]=e.template(c[a].join("\n"));return b}(),g=buildNodeVisitor({grammar:d("grammar"),initializer:function(a){return a.code},rule:d("rule"),choice:function(a){for(var b,d,e=a.alternatives.length-1;e>=0;e--)d=e!==a.alternatives.length-1?c("choice.next",{node:a,code:b}):"",b=c("choice",{alternative:a.alternatives[e],nextAlternativesCode:d});return b},sequence:function(a){for(var b=c("sequence.inner",{node:a}),d=a.elements.length-1;d>=0;d--)b=c("sequence.iteration",{node:a,element:a.elements[d],code:b});return c("sequence",{node:a,code:b})},labeled:function(a){return g(a.expression)},simple_and:d("simple_and"),simple_not:d("simple_not"),semantic_and:d("semantic_and"),semantic_not:d("semantic_not"),optional:d("optional"),zero_or_more:d("zero_or_more"),one_or_more:d("one_or_more"),action:d("action"),rule_ref:d("rule_ref"),literal:d("literal"),any:d("any"),"class":function(a){var b;return b=a.parts.length>0?"/^["+(a.inverted?"^":"")+map(a.parts,function(a){return a instanceof Array?quoteForRegexpClass(a[0])+"-"+quoteForRegexpClass(a[1]):quoteForRegexpClass(a)}).join("")+"]/"+(a.ignoreCase?"i":""):a.inverted?"/^[\\S\\s]/":"/^(?!)/",c("class",{node:a,regexp:b})}});return g(a)},PEG}();"undefined"!=typeof module&&(module.exports=PEG)},{}]},{},["F4GJtq"]);