
<!--
/*
 * Copyright 2012 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
-->

<html>
<head>
<script type="text/javascript" src="/lib/jasmine.js"></script>
<script type="text/javascript" src="/lib/jasmine-html.js"></script>
<script type="text/javascript" src="/lib/noder.min.js">
{
	resolver : {
		"default" : {
			"spec" :"/test/spec/"
		}
	},
	packaging : {
		baseUrl : "/"
	}
}
</script>
<link href="/lib/jasmine.css" type="text/css" rel="stylesheet"/>

</head>
<body>

<script type="noder">

// runtime tests

require("spec/json.spec.js");
require("spec/klass.spec.js");
require("spec/propobserver.spec.js");
require("spec/text.spec.js");
require("spec/elt.spec.js");
require("spec/if.spec.js");
require("spec/insert.spec.js");
require("spec/foreach.spec.js");
require("spec/evthandler.spec.js");

// TODO
// $text node 					OK
// data binding on properties	OK
// element nodes 				OK
// node list at root level		OK
// $if node						OK
// $insert						OK
// $foreach 					OK
// data binding on arrays		OK
// event handlers 				OK
// hsp.refresh()				OK
// hsp.display()				OK

// input node
// @attribute node?
// data binding on full expression path
// widgets
// function expressions
// long expression paths
// transitions
// adaptors?
// context variables?
// mobile event support


var reporter = new jasmine.TrivialReporter(), env = jasmine.getEnv();
env.addReporter(reporter);
env.execute();


// ###################################################################################
// Sample test
var hsp=require("hsp/rt"),
	json=require("hsp/json");

var p={name:"user"}
var count=0;

function handleClick() {
	count++;
	switch(count) {
		case 1:
			json.set(p,"name","you");
			break;
		case 2:
			json.set(p,"name","YOU (ok - no need to click any longer..)");
			break;
		case 3:
			json.set(p,"name","YOU (ok - no need to click any longer - THANKS!..)");
			break;
	}
}

function hello1(person) {
	if (!hello1.ng) {
		var Ng=require("hsp/rt").NodeGenerator, n=Ng.nodes;
		hello1.ng=new Ng([
			n.elt(
				"div",
				{e1:[4,handleClick]},
				{"title":"click me!"},
				{"click":1},
				[n.$text({e1:[1,"person","name"]},["hello ",1,"!"])]
				)
		]);
	}
	return hello1.ng.process(this,["person",person]);
}
/***
# template hello1(person)
	<div title="click me!" onclick="handleClick()">
		hello {person.name}!
	</div>
# /template
***/

hsp.display("testdiv", hello1(p)); 
// equivalent to document.getElementById("test").appendChild(hello1(p).node); 

</script>

<div id="testdiv"></div>

</body>
</html>